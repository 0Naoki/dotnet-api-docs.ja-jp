<span data-ttu-id="f2555-101">文字ベースのインデックスを使用して、<xref:System.Text.StringBuilder.Chars%2A>プロパティは、次の条件下で非常に低速であることができます。</span><span class="sxs-lookup"><span data-stu-id="f2555-101">Using character-based indexing with the <xref:System.Text.StringBuilder.Chars%2A> property can be extremely slow under the following conditions:</span></span>

- <span data-ttu-id="f2555-102"><xref:System.Text.StringBuilder>インスタンスが大きい (たとえば、含まれています数万文字)。</span><span class="sxs-lookup"><span data-stu-id="f2555-102">The <xref:System.Text.StringBuilder> instance is large (for example, it consists of several tens of thousands of characters).</span></span>
- <span data-ttu-id="f2555-103"><xref:System.Text.StringBuilder>は"chunky"なです。</span><span class="sxs-lookup"><span data-stu-id="f2555-103">The <xref:System.Text.StringBuilder> is "chunky."</span></span> <span data-ttu-id="f2555-104">つまりなどメソッドへの呼び出しを繰り返す<xref:System.Text.StringBuilder.Append%2A?displayProperty=nameWithType>オブジェクトの拡張に自動的に<xref:System.Text.StringBuilder.Capacity%2A?displayProperty=nameWithType>プロパティと、メモリの割り当てられた新しいチャンクです。</span><span class="sxs-lookup"><span data-stu-id="f2555-104">That is, repeated calls to methods such as <xref:System.Text.StringBuilder.Append%2A?displayProperty=nameWithType> have automatically expanded the object's <xref:System.Text.StringBuilder.Capacity%2A?displayProperty=nameWithType> property and allocated new chunks of memory to it.</span></span>

<span data-ttu-id="f2555-105">各文字のアクセスは、リンク リスト全体にインデックスを適切なバッファーを検索するチャンクのため、パフォーマンスが著しく低下します。</span><span class="sxs-lookup"><span data-stu-id="f2555-105">Performance is severely impacted because each character access walks the entire linked list of chunks to find the correct buffer to index into.</span></span>

> [!NOTE]
>  <span data-ttu-id="f2555-106">大規模なであっても"chunky な"<xref:System.Text.StringBuilder>オブジェクトを使用して、<xref:System.Text.StringBuilder.Chars%2A>プロパティを 1 つまたは少数の文字インデックス ベースのアクセスをごくわずかでありのパフォーマンスに影響は通常、これは、 **0 (n)**操作します。</span><span class="sxs-lookup"><span data-stu-id="f2555-106">Even for a large "chunky" <xref:System.Text.StringBuilder> object, using the <xref:System.Text.StringBuilder.Chars%2A> property for index-based access to one or a small number of characters has a negligible performance impact; typically, it is an **0(n)** operation.</span></span> <span data-ttu-id="f2555-107">内の文字を反復処理するときに、パフォーマンスに大きな影響が発生、<xref:System.Text.StringBuilder>オブジェクトは、 **O(n^2)**操作します。</span><span class="sxs-lookup"><span data-stu-id="f2555-107">The significant performance impact occurs when iterating the characters in the <xref:System.Text.StringBuilder> object, which is an **O(n^2)** operation.</span></span> 

<span data-ttu-id="f2555-108">文字ベースのインデックスを使用してパフォーマンスの問題が発生した場合<xref:System.Text.StringBuilder>オブジェクトを次の回避策のいずれかを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="f2555-108">If you encounter performance issues when using character-based indexing with <xref:System.Text.StringBuilder> objects, you can use any of the following workarounds:</span></span>

- <span data-ttu-id="f2555-109">変換、<xref:System.Text.StringBuilder>インスタンスを<xref:System.String>を呼び出して、<xref:System.Text.StringBuilder.ToString%2A>メソッドを文字列内の文字にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="f2555-109">Convert the <xref:System.Text.StringBuilder> instance to a <xref:System.String> by calling the <xref:System.Text.StringBuilder.ToString%2A> method, then access the characters in the string.</span></span>

- <span data-ttu-id="f2555-110">既存の内容をコピー<xref:System.Text.StringBuilder>を新しいオブジェクトが事前にサイズ設定<xref:System.Text.StringBuilder>オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="f2555-110">Copy the contents of the existing <xref:System.Text.StringBuilder> object to a new pre-sized <xref:System.Text.StringBuilder> object.</span></span> <span data-ttu-id="f2555-111">パフォーマンス向上のため、新しい<xref:System.Text.StringBuilder>chunky なオブジェクトではありません。</span><span class="sxs-lookup"><span data-stu-id="f2555-111">Performance improves because the new <xref:System.Text.StringBuilder> object is not chunky.</span></span> <span data-ttu-id="f2555-112">例:</span><span class="sxs-lookup"><span data-stu-id="f2555-112">For example:</span></span>

   ```csharp
   // sbOriginal is the existing StringBuilder object
   var sbNew = new StringBuilder(sbOriginal.ToString(), sbOriginal.Length);
   ```
   ```vb
   ' sbOriginal is the existing StringBuilder object
   Dim sbNew = New StringBuilder(sbOriginal.ToString(), sbOriginal.Length)
   ```
- <span data-ttu-id="f2555-113">初期容量の設定、<xref:System.Text.StringBuilder>は呼び出すことによって、最大の予想サイズにほぼ等しいを値にオブジェクト、<xref:System.Text.StringBuilder.%23ctor(System.Int32)>コンス トラクターです。</span><span class="sxs-lookup"><span data-stu-id="f2555-113">Set the initial capacity of the <xref:System.Text.StringBuilder> object to a value that is approximately equal to its maximum expected size by calling the <xref:System.Text.StringBuilder.%23ctor(System.Int32)> constructor.</span></span> <span data-ttu-id="f2555-114">場合であってもメモリ全体のブロックを割り当てますこのことに注意してください、<xref:System.Text.StringBuilder>ほとんど処理能力の上限に到達します。</span><span class="sxs-lookup"><span data-stu-id="f2555-114">Note that this allocates the entire block of memory even if the <xref:System.Text.StringBuilder> rarely reaches its maximum capacity.</span></span>

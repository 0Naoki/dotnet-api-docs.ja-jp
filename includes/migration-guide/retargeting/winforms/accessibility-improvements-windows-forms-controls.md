### <a name="accessibility-improvements-in-windows-forms-controls"></a><span data-ttu-id="8784a-101">Windows フォーム コントロールでのアクセシビリティの向上</span><span class="sxs-lookup"><span data-stu-id="8784a-101">Accessibility improvements in Windows Forms controls</span></span>

|   |   |
|---|---|
|<span data-ttu-id="8784a-102">説明</span><span class="sxs-lookup"><span data-stu-id="8784a-102">Details</span></span>|<span data-ttu-id="8784a-103">Windows フォームはアクセシビリティ テクノロジによってユーザー サポートの動作が向上します。</span><span class="sxs-lookup"><span data-stu-id="8784a-103">Windows Forms is improving how it works with accessibility technologies to better support Windows Forms customers.</span></span> <span data-ttu-id="8784a-104">次のような点が変更されます。</span><span class="sxs-lookup"><span data-stu-id="8784a-104">These include the following changes:</span></span><ul><li><span data-ttu-id="8784a-105">ハイ コントラスト モード中の表示が向上する変更。</span><span class="sxs-lookup"><span data-stu-id="8784a-105">Changes to improve display during High Contrast mode.</span></span></li><li><span data-ttu-id="8784a-106">プロパティ ブラウザーのエクスペリエンスが向上する変更。</span><span class="sxs-lookup"><span data-stu-id="8784a-106">Changes to improve the property browser experience.</span></span> <span data-ttu-id="8784a-107">プロパティ ブラウザーについては次のような点が向上します。</span><span class="sxs-lookup"><span data-stu-id="8784a-107">Property browser improvements include:</span></span></li><li><span data-ttu-id="8784a-108">さまざまなドロップダウン選択ウィンドウを利用することでキーボード操作が便利になりました。</span><span class="sxs-lookup"><span data-stu-id="8784a-108">Better keyboard navigation through the various drop-down selection windows.</span></span></li><li><span data-ttu-id="8784a-109">不要なタブ ストップが減ります。</span><span class="sxs-lookup"><span data-stu-id="8784a-109">Reduced unnecessary tab stops.</span></span></li><li><span data-ttu-id="8784a-110">コントロールの種類の報告機能が改善されました。</span><span class="sxs-lookup"><span data-stu-id="8784a-110">Better reporting of control types.</span></span></li><li><span data-ttu-id="8784a-111">ナレーターの動作が改善されました。</span><span class="sxs-lookup"><span data-stu-id="8784a-111">Improved narrator behavior.</span></span></li><li><span data-ttu-id="8784a-112">コントロールに不足している UI アクセシビリティ パターンを実装する変更。</span><span class="sxs-lookup"><span data-stu-id="8784a-112">Changes to implement missing UI accessibility patterns in controls.</span></span></li></ul>|
|<span data-ttu-id="8784a-113">提案される解決策</span><span class="sxs-lookup"><span data-stu-id="8784a-113">Suggestion</span></span>|<span data-ttu-id="8784a-114"><strong>以上の変更を選択する方法と選択しない方法</strong> アプリケーションでこれらの変更を利用するには、.NET Framework 4.7.1 以降で実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8784a-114"><strong>How to opt in or out of these changes</strong>In order for the application to benefit from these changes, it must run on the .NET Framework 4.7.1 or later.</span></span> <span data-ttu-id="8784a-115">アプリケーションは、次のいずれかの方法でこれらの変更を利用できます。</span><span class="sxs-lookup"><span data-stu-id="8784a-115">The application can benefit from these changes in either of the following ways:</span></span><ul><li><span data-ttu-id="8784a-116">.NET Framework 4.7.1 を対象にして再コンパイルします。</span><span class="sxs-lookup"><span data-stu-id="8784a-116">It is recompiled to target the .NET Framework 4.7.1.</span></span> <span data-ttu-id="8784a-117">.NET Framework 4.7.1 以降を対象とする Windows フォーム アプリケーションでは、これらのアクセシビリティの変更が既定で有効になります。</span><span class="sxs-lookup"><span data-stu-id="8784a-117">These accessibility changes are enabled by default on Windows Forms applications that target the .NET Framework 4.7.1 or later.</span></span></li><li><span data-ttu-id="8784a-118">下の例のように、app.config ファイルの <code>&lt;runtime&gt;</code> セクションに次の [AppContext スイッチ](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md)を追加し、それを <code>false</code> に設定することで、以前のアクセシビリティ動作を無効にします。</span><span class="sxs-lookup"><span data-stu-id="8784a-118">It opts out of the legacy accessibility behaviors by adding the following [AppContext switch](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) to the <code>&lt;runtime&gt;</code> section of the app.config file and setting it to <code>false</code>, as the following example shows.</span></span></li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre><span data-ttu-id="8784a-119">.NET Framework 4.7.1 以降を対象とするアプリケーションで以前のアクセシビリティ動作を残す場合、この AppContext スイッチを明示的に <code>true</code> に設定することで以前のアクセシビリティ機能を選択できます。UI オートメーションの概要については、「[UI オートメーションの概要](~/docs/framework/ui-automation/ui-automation-overview.md)」をご覧ください。<strong>UI オートメーション パターンとプロパティに対して追加されたサポート</strong> アクセシビリティ クライアントは、一般的なパブリックに記述された呼び出しパターンを使って、新しい WinForms アクセシビリティ機能を利用できます。</span><span class="sxs-lookup"><span data-stu-id="8784a-119">Applications that target the .NET Framework 4.7.1 or later and want to preserve the legacy accessibility behavior can opt in to the use of legacy accessibility features by explicitly setting this AppContext switch to <code>true</code>.For an overview of UI automation, see the [UI Automation Overview](~/docs/framework/ui-automation/ui-automation-overview.md).<strong>Added support for UI Automation patterns and properties</strong>Accessibility clients can take advantage of new WinForms accessibility functionality by using common, publicly described invocation patterns.</span></span> <span data-ttu-id="8784a-120">これらのパターンは、WinForms に固有ではありません。</span><span class="sxs-lookup"><span data-stu-id="8784a-120">These patterns are not WinForms-specific.</span></span> <span data-ttu-id="8784a-121">たとえば、アクセシビリティ クライアントは、IAccessible インターフェイス (MAAS) の QueryInterface メソッドを呼び出して、IServiceProvider インターフェイスを取得することができます。</span><span class="sxs-lookup"><span data-stu-id="8784a-121">For instance, accessibility clients can call the QueryInterface method on the IAccessible interface (MAAS) to obtain an IServiceProvider interface.</span></span> <span data-ttu-id="8784a-122">このインターフェイスを使用できる場合、クライアントはその QueryService メソッドを使って、IAccessibleEx インターフェイスを要求できます。</span><span class="sxs-lookup"><span data-stu-id="8784a-122">If this interface is available, clients can use its QueryService method to request an IAccessibleEx interface.</span></span> <span data-ttu-id="8784a-123">詳しくは、「[Using IAccessibleEx from a Client](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx)」(クライアントからの IAccessibleEx の使用) をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="8784a-123">For more information, see [Using IAccessibleEx from a Client](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx).</span></span> <span data-ttu-id="8784a-124">.NET Framework 4.7.1、IServiceProvider で始まると[IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (該当する場合) が WinForms ユーザー補助オブジェクトに対して使用します。 .NET Framework 4.7.1 は、次の UI オートメーション パターンやプロパティのサポートを追加します。</span><span class="sxs-lookup"><span data-stu-id="8784a-124">Starting with the .NET Framework 4.7.1, IServiceProvider and [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (where applicable) are available for WinForms accessibility objects.The .NET Framework 4.7.1 adds support for the following UI automation patterns and properties:</span></span><ul><li><span data-ttu-id="8784a-125"><code>T:System.Windows.Forms.ToolStripSplitButton</code> および <code>T:System.Windows.Forms.ComboBox</code> コントロールは、[展開/折りたたみパターン](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)をサポートします。</span><span class="sxs-lookup"><span data-stu-id="8784a-125">The <code>T:System.Windows.Forms.ToolStripSplitButton</code> and <code>T:System.Windows.Forms.ComboBox</code> controls support the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="8784a-126"><code>T:System.Windows.Forms.ToolStripMenuItem</code> コントロールの [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) プロパティの値は <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType> です。</span><span class="sxs-lookup"><span data-stu-id="8784a-126">The <code>T:System.Windows.Forms.ToolStripMenuItem</code> control has a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="8784a-127"><code>T:System.Windows.Forms.ToolStripItem</code> コントロールは、[Name](xref:System.Windows.Automation.AutomationElement.NameProperty) プロパティと[展開/折りたたみパターン](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)をサポートします。</span><span class="sxs-lookup"><span data-stu-id="8784a-127">The <code>T:System.Windows.Forms.ToolStripItem</code> control supports the [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) property and [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="8784a-128"><code>T:System.Windows.Forms.ToolStripDropDownItem</code> コントロールは、ドロップダウンが展開されたり折りたたまれたりしたときの StateChange と NameChange を示す <xref:System.Windows.Forms.AccessibleEvents> をサポートします。</span><span class="sxs-lookup"><span data-stu-id="8784a-128">The <code>T:System.Windows.Forms.ToolStripDropDownItem</code> control supports <xref:System.Windows.Forms.AccessibleEvents> indicating StateChange and NameChange when drop down is expanded or collapsed.</span></span></li><li><span data-ttu-id="8784a-129"><code>T:System.Windows.Forms.ToolStripDropDownButton</code> コントロールの [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) プロパティの値は <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType> です。</span><span class="sxs-lookup"><span data-stu-id="8784a-129">The <code>T:System.Windows.Forms.ToolStripDropDownButton</code> control has a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value of <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="8784a-130"><code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> コントロールは[トグル パターン](xref:System.Windows.Automation.TogglePattern)をサポートします。</span><span class="sxs-lookup"><span data-stu-id="8784a-130">The <code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> control supports the [Toggle Pattern](xref:System.Windows.Automation.TogglePattern).</span></span></li><li><span data-ttu-id="8784a-131"><code>T:System.Windows.Forms.NumericUpDown</code> および <code>T:System.Windows.Forms.DomainUpDown</code> コントロールは、[Name](xref:System.Windows.Automation.AutomationElement.NameProperty) をサポートし、[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) は <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType> です。</span><span class="sxs-lookup"><span data-stu-id="8784a-131">The <code>T:System.Windows.Forms.NumericUpDown</code> and <code>T:System.Windows.Forms.DomainUpDown</code> controls support the [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) and have a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) of <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</span></span></li></ul><span data-ttu-id="8784a-132"><strong>PropertyGrid コントロールの向上</strong> .NET Framework 4.7.1 では、PropertyBrowser コントロールが次のように向上します。</span><span class="sxs-lookup"><span data-stu-id="8784a-132"><strong>Improvements to the PropertyGrid control</strong>The .NET Framework 4.7.1 adds the following improvements to the PropertyBrowser control:</span></span><ul><li><span data-ttu-id="8784a-133">ユーザーが <code>T:System.Windows.Forms.PropertyGrid</code> コントロールに誤った値を入力すると表示されるエラー ダイアログの <strong>[詳細]</strong> ボタンは、[展開/折りたたみパターン](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)、状態と名前の変更通知、および [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) プロパティの値 <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType> をサポートします。</span><span class="sxs-lookup"><span data-stu-id="8784a-133">The <strong>Details</strong> button in the error dialog that is displayed when the user enters an incorrect value in the <code>T:System.Windows.Forms.PropertyGrid</code> control supports the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), state and name change notifications, and a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property with a value of <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="8784a-134">エラー ダイアログの <strong>[詳細]</strong> ボタンを展開すると表示されるメッセージ ウィンドウは、キーボードでアクセスできるようになり、エラー メッセージの内容をナレーターで読み上げることができます。</span><span class="sxs-lookup"><span data-stu-id="8784a-134">The message pane displayed when the <strong>Details</strong> button of the error dialog is expanded is now keyboard accessible and allows Narrator to announce the content of the error message.</span></span></li><li><span data-ttu-id="8784a-135"><code>T:System.Windows.Forms.PropertyGrid</code> コントロールの行の <xref:System.Windows.Forms.AccessibleRole> は、&quot;Row&quot; から &quot;Cell&quot; に変更されました。</span><span class="sxs-lookup"><span data-stu-id="8784a-135">The <xref:System.Windows.Forms.AccessibleRole> of rows in <code>T:System.Windows.Forms.PropertyGrid</code> control have changed from &quot;Row&quot; to &quot;Cell&quot;.</span></span> <span data-ttu-id="8784a-136">セルは UIA の ControlType &quot;DataItem&quot; にマップし、適切なキーボード ショートカットとナレーターの読み上げをサポートすることができます。</span><span class="sxs-lookup"><span data-stu-id="8784a-136">The cell maps to UIA ControlType &quot;DataItem&quot;, which allows it to support appropriate keyboard shortcuts and Narrator announcements.</span></span></li><li><span data-ttu-id="8784a-137"><code>T:System.Windows.Forms.PropertyGrid</code> コントロールの <code>P:System.Windows.Forms.PropertySort</code> プロパティが <code>F:System.Windows.Forms.PropertySory.Categorized</code> に設定されているときにヘッダー項目を表す <code>T:System.Windows.Forms.PropertyGrid</code> コントロールの行は、[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) プロパティの値が <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType> です。</span><span class="sxs-lookup"><span data-stu-id="8784a-137">The <code>T:System.Windows.Forms.PropertyGrid</code> control rows which represent header items when the <code>T:System.Windows.Forms.PropertyGrid</code> control has a <code>P:System.Windows.Forms.PropertySort</code> property set to <code>F:System.Windows.Forms.PropertySory.Categorized</code> have a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value of <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></span></span></li><li><span data-ttu-id="8784a-138"><code>T:System.Windows.Forms.PropertyGrid</code> コントロールの <code>P:System.Windows.Forms.PropertySort</code> プロパティが <code>F:System.Windows.Forms.PropertySory.Categorized</code> に設定されているときにヘッダー項目を表す <code>T:System.Windows.Forms.PropertyGrid</code> コントロールの行は、[展開/折りたたみパターン](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)をサポートします。</span><span class="sxs-lookup"><span data-stu-id="8784a-138">The <code>T:System.Windows.Forms.PropertyGrid</code> control rows which represent header items when the <code>T:System.Windows.Forms.PropertyGrid</code> control has a <code>P:System.Windows.Forms.PropertySort</code> property set to <code>F:System.Windows.Forms.PropertySory.Categorized</code> support the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="8784a-139">グリッドとその上にある ToolBar の間のキーボード ナビゲーションが向上します。</span><span class="sxs-lookup"><span data-stu-id="8784a-139">Improved keyboard navigation between the grid and the ToolBar above it.</span></span> <span data-ttu-id="8784a-140">&quot;Shift + Tab&quot; キーを押すと、ToolBar 全体ではなく、ToolBar の最初のボタンが選択されます。</span><span class="sxs-lookup"><span data-stu-id="8784a-140">Pressing &quot;Shift-Tab&quot; now selects the first ToolBar button, instead of the whole ToolBar</span></span></li><li><span data-ttu-id="8784a-141">ハイ コントラスト モードで表示された <code>T:System.Windows.Forms.PropertyGrid</code> コントロールでは、<code>P:System.Windows.Forms.PropertySort</code> プロパティの現在の値に対応する ToolBar ボタンの周囲にフォーカス四角形が描画されます。</span><span class="sxs-lookup"><span data-stu-id="8784a-141"><code>T:System.Windows.Forms.PropertyGrid</code> controls displayed in High Contrast mode will now draw a focus rectangle around the ToolBar button which corresponds to the current <code>P:System.Windows.Forms.PropertySort</code> property value.</span></span></li><li><span data-ttu-id="8784a-142">ハイ コントラスト モードで表示され、<code>P:System.Windows.Forms.PropertySort</code> プロパティが <code>F:System.Windows.Forms.PropertySory.Categorized</code> に設定された <code>T:System.Windows.Forms.PropertyGrid</code> コントロールでは、カテゴリ ヘッダーの背景がハイ コントラストの色で表示されます。</span><span class="sxs-lookup"><span data-stu-id="8784a-142"><code>T:System.Windows.Forms.PropertyGrid</code> controls displayed in High Contrast mode and with a <code>P:System.Windows.Forms.PropertySort</code> property set to <code>F:System.Windows.Forms.PropertySory.Categorized</code> will now display the background of category headers in a highly contrasting color.</span></span></li><li><span data-ttu-id="8784a-143"><code>T:System.Windows.Forms.PropertyGrid</code> コントロールでは、フォーカスが設定された ToolBar 項目と、<code>P:System.Windows.Forms.PropertySort</code> プロパティの現在の値を示す ToolBar 項目の区別が明確になります。</span><span class="sxs-lookup"><span data-stu-id="8784a-143"><code>T:System.Windows.Forms.PropertyGrid</code> controls better differentiates between ToolBar items with focus and the ToolBar items which indicate the current value of the <code>P:System.Windows.Forms.PropertySort</code> property.</span></span> <span data-ttu-id="8784a-144">この修正は、ハイ コントラストの変更と、非ハイ コントラストのシナリオに対する変更で構成されます。</span><span class="sxs-lookup"><span data-stu-id="8784a-144">This fix consists of a High Contrast change and a change for non-High Contrast scenarios.</span></span></li><li><span data-ttu-id="8784a-145"><code>P:System.Windows.Forms.PropertySort</code> プロパティの現在の値を示す <code>T:System.Windows.Forms.PropertyGrid</code> コントロールの ToolBar 項目は、[トグル パターン](xref:System.Windows.Automation.TogglePattern)をサポートします。</span><span class="sxs-lookup"><span data-stu-id="8784a-145"><code>T:System.Windows.Forms.PropertyGrid</code> control ToolBar items which indicates the current value of the <code>P:System.Windows.Forms.PropertySort</code> property support the [Toggle Pattern](xref:System.Windows.Automation.TogglePattern).</span></span></li><li><span data-ttu-id="8784a-146">配置ピッカーで選択された配置を区別するナレーターのサポートが向上します。</span><span class="sxs-lookup"><span data-stu-id="8784a-146">Improved Narrator support for distinguishing the selected alignment in the Alignment Picker.</span></span></li><li><span data-ttu-id="8784a-147">空の <code>T:System.Windows.Forms.PropertyGrid</code> コントロールがフォームに表示されているとき、以前はフォーカスを設定されませんでしたが、現在はフォーカスを設定されるようになっています。</span><span class="sxs-lookup"><span data-stu-id="8784a-147">When an empty <code>T:System.Windows.Forms.PropertyGrid</code> control is displayed on a form, it will now receive focus where previously it would not.</span></span></li></ul><span data-ttu-id="8784a-148"><strong>ハイ コントラスト テーマでの OS で定義された色の使用</strong></span><span class="sxs-lookup"><span data-stu-id="8784a-148"><strong>Use of OS-defined colors in High Contrast themes</strong></span></span><ul><li><span data-ttu-id="8784a-149"><code>P:System.Windows.Forms.Control.FlatStyle</code> が <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType> (既定のスタイル) に設定された <code>T:System.Windows.Forms.Button</code> および <code>T:System.Windows.Forms.CheckBox</code> コントロールは、ハイ コントラスト テーマが選択されているときは OS で定義された色を使用するようになります。</span><span class="sxs-lookup"><span data-stu-id="8784a-149"><code>T:System.Windows.Forms.Button</code> and <code>T:System.Windows.Forms.CheckBox</code> controls with <code>P:System.Windows.Forms.Control.FlatStyle</code> set to <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, which is the default style, now use OS-defined colors in High Contrast theme when selected.</span></span> <span data-ttu-id="8784a-150">以前は、テキストと背景の色はコントラストが同じで、見分けるのが困難でした。</span><span class="sxs-lookup"><span data-stu-id="8784a-150">Previously, text and background colors were not contrasting and were hard to read.</span></span></li><li><span data-ttu-id="8784a-151"><code>P:System.Windows.Forms.Control.Enabled</code> が <em>false</em> に設定された <code>T:System.Windows.Forms.Button</code>、<code>T:System.Windows.Forms.CheckBox</code>、<code>T:System.Windows.Forms.RadioButton</code>、<code>T:System.Windows.Forms.Label</code>、<code>T:System.Windows.Forms.LinkLabel</code>、および <code>T:System.Windows.Forms.GroupBox</code> は、以前は影付きの色を使ってハイ コントラスト テーマのテキストをレンダリングしており、背景に対するコントラストが低くなっていました。</span><span class="sxs-lookup"><span data-stu-id="8784a-151"><code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> and <code>T:System.Windows.Forms.GroupBox</code> with<code>P:System.Windows.Forms.Control.Enabled</code> set to <em>false</em>, used a shaded color to render text in High Contrast themes, resulting in low contrast against the background.</span></span> <span data-ttu-id="8784a-152">現在は、これらのコントロールは OS によって定義された &quot;無効なテキスト&quot; の色を使うようになっています。</span><span class="sxs-lookup"><span data-stu-id="8784a-152">Now these controls use &quot;Disabled Text&quot; color defined by the OS.</span></span> <span data-ttu-id="8784a-153">この修正は、<code>P:System.Windows.Forms.Control.FlatStyle</code> プロパティが <code>F:System.Windows.Forms.FlatStyle.System</code> 以外の値に設定されたコントロールに適用されます。</span><span class="sxs-lookup"><span data-stu-id="8784a-153">This fix applies to controls with <code>P:System.Windows.Forms.Control.FlatStyle</code> property set to a value other than <code>F:System.Windows.Forms.FlatStyle.System</code>.</span></span> <span data-ttu-id="8784a-154">後者のコントロールは OS によってレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="8784a-154">The latter controls are rendered by the OS.</span></span></li><li><span data-ttu-id="8784a-155"><code>T:System.Windows.Forms.DataGridView</code> では、現在フォーカスが設定されているセルの内容を囲むように目に見える四角形がレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="8784a-155"><code>T:System.Windows.Forms.DataGridView</code> now renders a visible rectangle around the content of the cell which has the current focus.</span></span> <span data-ttu-id="8784a-156">以前は、特定のハイ コントラスト テーマではこれは見えませんでした。</span><span class="sxs-lookup"><span data-stu-id="8784a-156">Previously, this was not visible in certain High Contrast themes.</span></span></li><li><span data-ttu-id="8784a-157"><code>P:System.Windows.Forms.ToolStripItem.Enabled</code> プロパティが <em>false</em> に設定された <code>T:System.Windows.Forms.ToolStripMenuItem</code> コントロールは、OS によって定義された &quot;無効なテキスト&quot; の色を使うようになります。</span><span class="sxs-lookup"><span data-stu-id="8784a-157"><code>T:System.Windows.Forms.ToolStripMenuItem</code> controls with a <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> property set to <em>false</em> now use the &quot;Disabled Text&quot; color defined by the OS.</span></span></li><li><span data-ttu-id="8784a-158"><code>P:System.Windows.Forms.ToolStripItem.Checked</code> プロパティが <em>true</em> に設定された <code>T:System.Windows.Forms.ToolStripMenuItem</code> コントロールは、コントラストのあるシステム カラーで関連するチェック マークをレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="8784a-158"><code>T:System.Windows.Forms.ToolStripMenuItem</code> controls with a <code>P:System.Windows.Forms.ToolStripItem.Checked</code> property set to <em>true</em> now render the associated check mark in a contrasting system color.</span></span>  <span data-ttu-id="8784a-159">以前は、チェック マークの色に十分なコントラストがなく、ハイ コントラスト テーマでは見えませんでした。</span><span class="sxs-lookup"><span data-stu-id="8784a-159">Previously the check mark color was not contrasting enough and not visible in High Contrast themes.</span></span></li></ul><span data-ttu-id="8784a-160">注: Windows 10 では、一部のハイ コントラストのシステム カラーの値が変更されています。</span><span class="sxs-lookup"><span data-stu-id="8784a-160">NOTE: Windows10 has changed values for some high contrast system colors.</span></span> <span data-ttu-id="8784a-161">Windows フォームのフレームワークは、Win32 フレームワークに基づいています。</span><span class="sxs-lookup"><span data-stu-id="8784a-161">Windows Forms Framework is based on the Win32 framework.</span></span> <span data-ttu-id="8784a-162">最も快適に利用するためには、最新版の Windows で実行し、テスト アプリケーションに app.manifest ファイルを追加して最新の OS 変更を選択し、次のコードのコメントを解除します。</span><span class="sxs-lookup"><span data-stu-id="8784a-162">For the best experience, run on the latest version of Windows and opt in to the latest OS changes by adding an app.manifest file in a test application and uncommenting the following code:</span></span><pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><span data-ttu-id="8784a-163"><strong>キーボード ナビゲーションの向上</strong></span><span class="sxs-lookup"><span data-stu-id="8784a-163"><strong>Improved keyboard navigation</strong></span></span><ul><li><span data-ttu-id="8784a-164"><code>T:System.Windows.Forms.ComboBox</code> コントロールの <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> が <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> に設定されていて、フォームのタブ オーダーで最初のコントロールである場合、キーボードを使って親フォームが開かれると、コントロールにフォーカスの四角形が表示されます。</span><span class="sxs-lookup"><span data-stu-id="8784a-164">When a <code>T:System.Windows.Forms.ComboBox</code> control has <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> set to <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> and is the first control in the tab order on the form, it now displays a focus rectangle when the parent form is opened using the keyboard.</span></span> <span data-ttu-id="8784a-165">この変更の前は、キーボード フォーカスはこのコントロールに設定されましたが、フォーカス インジケーターはレンダリングされませんでした。</span><span class="sxs-lookup"><span data-stu-id="8784a-165">Before this change, keyboard focus was on this control, but a focus indicator was not rendered.</span></span></li></ul><span data-ttu-id="8784a-166"><strong>ナレーター サポートが改善されました</strong></span><span class="sxs-lookup"><span data-stu-id="8784a-166"><strong>Improved Narrator support</strong></span></span><ul><li><span data-ttu-id="8784a-167"><code>T:System.Windows.Forms.MonthCalendar</code> コントロールに、以前は行われなかったナレーターによるコントロールの値の読み上げなど、コントロールにアクセスするための支援技術のサポートが追加されました。</span><span class="sxs-lookup"><span data-stu-id="8784a-167">The <code>T:System.Windows.Forms.MonthCalendar</code> control has added support for assistive technologies to access the control, including the ability for Narrator to read the value of the control when previously it could not.</span></span></li><li><span data-ttu-id="8784a-168"><code>T:System.Windows.Forms.CheckedListBox</code> コントロールは、<code>P:System.Windows.Forms.CheckState</code> プロパティが変更されるとナレーターに通知するようになりました。</span><span class="sxs-lookup"><span data-stu-id="8784a-168">The <code>T:System.Windows.Forms.CheckedListBox</code> control now notifies Narrator when the <code>P:System.Windows.Forms.CheckState</code> property has been changed.</span></span> <span data-ttu-id="8784a-169">以前は、ナレーターは通知を受け取らなかったため、ユーザーは <code>P:System.Windows.Forms.CheckState</code> が更新されたことを教えられませんでした。</span><span class="sxs-lookup"><span data-stu-id="8784a-169">Previously, Narrator did not recieve notification and as a result users would not be informed that the <code>P:System.Windows.Forms.CheckState</code> had been updated.</span></span></li><li><span data-ttu-id="8784a-170"><code>T:System.Windows.Forms.LinkLabel</code> コントロールがコントロール内のテキストをナレーターに通知する方法が変更されました。</span><span class="sxs-lookup"><span data-stu-id="8784a-170">The <code>T:System.Windows.Forms.LinkLabel</code> control has changed the way it notifies Narrator of the text of in the control.</span></span> <span data-ttu-id="8784a-171">以前は、ナレーターはこのテキストを 2 回読み上げ、ユーザーには表示されなくても &quot;&amp;&quot; 記号を実際のテキストとして読んでいました。</span><span class="sxs-lookup"><span data-stu-id="8784a-171">Previously, Narrator announced this text twice and read &quot;&amp;&quot; symbols as real text even though they are not visible to a user.</span></span> <span data-ttu-id="8784a-172">重複するテキストおよび不要な &quot;&amp;&quot; 記号が、ナレーターの読み上げから除去されました。</span><span class="sxs-lookup"><span data-stu-id="8784a-172">The duplicated text was removed from the Narrator announcements, as well as unnecessary &quot;&amp;&quot; symbols.</span></span></li><li><span data-ttu-id="8784a-173"><code>T:System.Windows.Forms.DataGridViewCell</code> コントロールの種類が、読み取り専用の状態をナレーターおよびその他の支援技術に正しくレポートするようになりました。</span><span class="sxs-lookup"><span data-stu-id="8784a-173">The <code>T:System.Windows.Forms.DataGridViewCell</code> control types now correctly report the read-only status to Narrator and other assistive technologies.</span></span></li><li><span data-ttu-id="8784a-174">ナレーターは、[マルチドキュメント インターフェイス](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) アプリケーションの子ウィンドウのシステム メニューを読み上げられるようになりました。</span><span class="sxs-lookup"><span data-stu-id="8784a-174">Narrator is now able to read the System Menu of child windows in [Multiple-Document Interface](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) applications.</span></span></li><li><span data-ttu-id="8784a-175">ナレーターは、<code>P:System.Windows.Forms.ToolStripItem.Enabled</code> プロパティが <em>false</em> に設定された <code>T:System.Windows.Forms.ToolStripMenuItem</code> コントロールを読み上げられるようになりました。</span><span class="sxs-lookup"><span data-stu-id="8784a-175">Narrator is now able to read <code>T:System.Windows.Forms.ToolStripMenuItem</code> controls with a <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> property set to <em>false</em>.</span></span> <span data-ttu-id="8784a-176">以前のナレーターは、無効なメニュー項目にフォーカスを設定できず、内容を読み上げることができませんでした。</span><span class="sxs-lookup"><span data-stu-id="8784a-176">Previously, Narrator was unable to focus on disabled menu items to read hte content.</span></span></li></ul>|
|<span data-ttu-id="8784a-177">スコープ</span><span class="sxs-lookup"><span data-stu-id="8784a-177">Scope</span></span>|<span data-ttu-id="8784a-178">Major</span><span class="sxs-lookup"><span data-stu-id="8784a-178">Major</span></span>|
|<span data-ttu-id="8784a-179">Version</span><span class="sxs-lookup"><span data-stu-id="8784a-179">Version</span></span>|<span data-ttu-id="8784a-180">4.7.1</span><span class="sxs-lookup"><span data-stu-id="8784a-180">4.7.1</span></span>|
|<span data-ttu-id="8784a-181">型</span><span class="sxs-lookup"><span data-stu-id="8784a-181">Type</span></span>|<span data-ttu-id="8784a-182">再ターゲット中</span><span class="sxs-lookup"><span data-stu-id="8784a-182">Retargeting</span></span>|
|<span data-ttu-id="8784a-183">影響を受ける API</span><span class="sxs-lookup"><span data-stu-id="8784a-183">Affected APIs</span></span>|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[<span data-ttu-id="8784a-184">MonthCalendar.AccessibilityObject</span><span class="sxs-lookup"><span data-stu-id="8784a-184">MonthCalendar.AccessibilityObject</span></span>](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|


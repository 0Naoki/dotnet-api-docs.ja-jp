### <a name="accessibility-improvements-in-windows-forms-controls"></a>Windows フォーム コントロールでのユーザー補助機能強化

|   |   |
|---|---|
|説明|Windows フォームでは、そのしくみのユーザー補助テクノロジを適切にサポートと Windows フォームの顧客を向上です。 次の変更が含まれます。<ul><li>ハイ コントラスト モード中にディスプレイを向上させるために変更します。</li><li>プロパティ ブラウザー エクスペリエンスを向上させるために変更します。 プロパティ ブラウザーの機能強化は次のとおりです。</li><li>さまざまなドロップダウン選択ウィンドウを利用することでキーボード操作が便利になりました。</li><li>不要なタブ ストップを削減します。</li><li>コントロールの種類の報告機能が改善されました。</li><li>ナレーターの動作が改善されました。</li><li>コントロールに不足している UI ユーザー補助のパターンを実装する変更です。</li></ul>|
|提案される解決策|<strong>これらの変更を有効または無効ハウツー</strong>.NET Framework 4.7.1 上これらの変更を活用するためにアプリケーションの順序で実行する必要がありますまたはそれ以降。 アプリケーションでは、次の方法のいずれかでこれらの変更を活用できます。<ul><li>これは、.NET Framework 4.7.1 を対象再コンパイルされます。 これらのユーザー補助機能の変更は、.NET Framework 4.7.1 を対象とする Windows フォーム アプリケーションでは既定で有効になっている以降です。</li><li>次を追加することで、従来のユーザー補助機能の動作を止めた、 [AppContext スイッチ](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md)を<code>&lt;runtime&gt;</code>に設定して、app.config ファイルのセクション<code>false</code>次の例に示すように、します。</li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>4.7.1 .NET Framework を対象とするアプリケーションまたはそれ以降、従来の保持してユーザー補助機能の動作を有効にできます従来のユーザー補助機能を使用この AppContext スイッチを明示的に設定して<code>true</code>です。UI オートメーションの概要については、次を参照してください、 [UI オートメーションの概要](~/docs/framework/ui-automation/ui-automation-overview.md)。 <strong>。UI オートメーション パターンやプロパティのサポートが追加されました</strong>ユーザー補助クライアントを利用 WinForms の新しいユーザー補助機能の一般的なパブリックに記載されている呼び出しパターンを使用しています。 これらのパターンは、WinForms に固有ではありません。 たとえば、ユーザー補助クライアントでは、IAccessible インターフェイス IServiceProvider インターフェイスを取得するには、(MAAS) の QueryInterface メソッドを呼び出すことができます。 このインターフェイスを使用できる場合、クライアントは、IAccessibleEx インターフェイスを要求する、QueryService メソッドを使用できます。 詳細については、次を参照してください。[からクライアントを使用して IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx)です。 .NET Framework 4.7.1、IServiceProvider で始まると[IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (該当する場合) が WinForms ユーザー補助オブジェクトに対して使用します。 .NET Framework 4.7.1 は、次の UI オートメーション パターンやプロパティのサポートを追加します。<ul><li><code>T:System.Windows.Forms.ToolStripSplitButton</code>と<code>T:System.Windows.Forms.ComboBox</code>のサポートを制御、[展開/折りたたみパターン](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)です。</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code>コントロールが、 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)プロパティ値<xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>です。</li><li><code>T:System.Windows.Forms.ToolStripItem</code>サポート、[名前](xref:System.Windows.Automation.AutomationElement.NameProperty)プロパティおよび[展開/折りたたみパターン](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)です。</li><li><code>T:System.Windows.Forms.ToolStripDropDownItem</code>サポート<xref:System.Windows.Forms.AccessibleEvents>を示す StateChange NameChange ドロップダウンが展開されたり、折りたたまれている場合。</li><li><code>T:System.Windows.Forms.ToolStripDropDownButton</code>コントロールが、 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)のプロパティの値<xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>です。</li><li><code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code>サポート、[トグル パターン](xref:System.Windows.Automation.TogglePattern)です。</li><li><code>T:System.Windows.Forms.NumericUpDown</code>と<code>T:System.Windows.Forms.DomainUpDown</code>のサポートを制御、[名前](xref:System.Windows.Automation.AutomationElement.NameProperty)いて、 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md)の<xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>します。</li></ul><strong>PropertyGrid 制御の機能強化</strong>4.7.1 の .NET Framework では、次の機能強化をプロパティ ブラウザー コントロールに追加します。<ul><li><strong>詳細</strong>に誤った値が入力されたときに表示されるエラー ダイアログのボタン、<code>T:System.Windows.Forms.PropertyGrid</code>サポート、[展開/折りたたみパターン](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)、状態と名前の変更通知、および、 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)の値を持つプロパティ<xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>です。</li><li>メッセージ ペインには、ときに表示される、<strong>詳細</strong>エラー ダイアログのボタンが展開されている現在は、キーボード アクセスでき、エラー メッセージの内容を読み上げる、ナレーターです。</li><li><xref:System.Windows.Forms.AccessibleRole>内の行の<code>T:System.Windows.Forms.PropertyGrid</code>から変更されているコントロール&quot;行&quot;に&quot;セル&quot;です。 セルに UIA ControlType マップ&quot;DataItem&quot;、適切なキーボード ショートカットとナレーター アナウンスをサポートすることができます。</li><li><code>T:System.Windows.Forms.PropertyGrid</code>ときに項目を表すヘッダー行の制御、<code>T:System.Windows.Forms.PropertyGrid</code>コントロールが、<code>P:System.Windows.Forms.PropertySort</code>プロパティに設定<code>F:System.Windows.Forms.PropertySory.Categorized</code>が、 [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)のプロパティの値 <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></li><li><code>T:System.Windows.Forms.PropertyGrid</code>ときに項目を表すヘッダー行の制御、<code>T:System.Windows.Forms.PropertyGrid</code>コントロールが、<code>P:System.Windows.Forms.PropertySort</code>プロパティに設定<code>F:System.Windows.Forms.PropertySory.Categorized</code>サポート、[展開/折りたたみパターン](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)です。</li><li>グリッドとその上にあるツールバーの間の向上のキーボード ナビゲーション。 キーを押して&quot;Shift タブ&quot;全体のツールバーではなく、最初のツール バー ボタンが選択</li><li><code>T:System.Windows.Forms.PropertyGrid</code> 現在、ハイ コントラスト モードで表示されるコントロールで対応する、ツール バー ボタンの周囲のフォーカスされた四角形が描画されます今すぐ<code>P:System.Windows.Forms.PropertySort</code>プロパティの値。</li><li><code>T:System.Windows.Forms.PropertyGrid</code> 使用して、ハイ コントラスト モードで表示されるコントロール、<code>P:System.Windows.Forms.PropertySort</code>プロパティに設定<code>F:System.Windows.Forms.PropertySory.Categorized</code>高対照的な色のカテゴリ ヘッダーの背景を今すぐ表示になります。</li><li><code>T:System.Windows.Forms.PropertyGrid</code> コントロールよりフォーカスがあるツールバーの項目と区別ツールバー項目の現在の値を示す、<code>P:System.Windows.Forms.PropertySort</code>プロパティです。 この修正プログラムは、ハイ コントラストの変更と非ハイ コントラストのシナリオに対する変更で構成されます。</li><li><code>T:System.Windows.Forms.PropertyGrid</code> コントロールの現在の値を示すツールバー項目を<code>P:System.Windows.Forms.PropertySort</code>プロパティのサポート、[トグル パターン](xref:System.Windows.Automation.TogglePattern)です。</li><li>ナレーターのサポート強化配置ピッカーで選択した配置を識別します。</li><li>ときに、空<code>T:System.Windows.Forms.PropertyGrid</code>コントロールがフォームに表示される、ようになりましたが、以前はの場合とないフォーカスを受け取ることができます。</li></ul><strong>ハイ コントラスト テーマでの OS で定義された色の使用</strong><ul><li><code>T:System.Windows.Forms.Button</code> および<code>T:System.Windows.Forms.CheckBox</code>と制御<code>P:System.Windows.Forms.Control.FlatStyle</code>'éý'<xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>既定のスタイルは、選択した場合、ハイ コントラスト テーマで OS で定義された色を使用するようになりました。 以前は、テキスト色と背景色コントラストがないを読み取ることは困難でした。</li><li><code>T:System.Windows.Forms.Button</code>、 <code>T:System.Windows.Forms.CheckBox</code>、 <code>T:System.Windows.Forms.RadioButton</code>、 <code>T:System.Windows.Forms.Label</code>、<code>T:System.Windows.Forms.LinkLabel</code>と<code>T:System.Windows.Forms.GroupBox</code>で<code>P:System.Windows.Forms.Control.Enabled</code>に設定<em>false</em>、に対して低コントラストの結果として得られる、ハイ コントラスト テーマでのテキストを表示するために影付きの色を使用しますバック グラウンドします。 これで、これらのコントロールを使用して&quot;無効なテキスト&quot;OS によって定義された色。 この修正プログラムを持つコントロールに適用<code>P:System.Windows.Forms.Control.FlatStyle</code>以外の値に設定するプロパティ<code>F:System.Windows.Forms.FlatStyle.System</code>です。 オペレーティング システムによっては、後者のコントロールが表示されます。</li><li><code>T:System.Windows.Forms.DataGridView</code> 現在フォーカスがセルの内容を囲む四角形が表示されているようになりましたが表示されます。 以前は、特定のハイ コントラスト テーマで表示されているでした。</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> 制御、<code>P:System.Windows.Forms.ToolStripItem.Enabled</code>プロパティに設定<em>false</em>使用できるように、&quot;無効なテキスト&quot;OS によって定義された色。</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> 制御、<code>P:System.Windows.Forms.ToolStripItem.Checked</code>プロパティに設定<em>true</em>対照的なシステム カラーの関連付けられているチェック マークが表示されます。  以前のチェック マークの色がないコントラスト十分なハイ コントラスト テーマでは表示されていません。</li></ul>注: windows 10 には、ハイ コントラスト システムの一部の色の値が変更されました。 Windows フォームのフレームワークは、Win32 フレームワークに基づいています。 最良の結果では、最新バージョンの Windows で実行し、テスト アプリケーションで app.manifest ファイルを追加して、次のコードのコメントを解除で OS の最新の変更を選択します。<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>強化されたキーボード ナビゲーション</strong><ul><li>ときに、<code>T:System.Windows.Forms.ComboBox</code>コントロールに<code>P:System.Windows.Forms.ComboBox.DropDownStyle</code>'éý'<code>F:System.Windows.Forms.DropDownStyle.DropDownList</code>キーボードを使用して、親フォームを開いたときにフォーカス四角形を今すぐ表示フォームで、タブの最初のコントロールで注文します。 この変更の前に、このコントロールがキーボード フォーカスがフォーカス インジケーターは表示されませんでした。</li></ul><strong>ナレーター サポートが改善されました</strong><ul><li><code>T:System.Windows.Forms.MonthCalendar</code>コントロールには、ナレーターいた可能性がありますいないときに、コントロールの値を読み取るための機能など、コントロールにアクセスする支援技術にとってのサポートが追加されました。</li><li><code>T:System.Windows.Forms.CheckedListBox</code>コントロールでは、ナレーターで通知されるときに、<code>P:System.Windows.Forms.CheckState</code>プロパティが変更されました。 以前は、ナレーターは通知を受け取っていないと、その結果ユーザーはありません通知を<code>P:System.Windows.Forms.CheckState</code>が更新されています。</li><li><code>T:System.Windows.Forms.LinkLabel</code>コントロールがコントロール内のテキストのナレーターに通知する方法を変更します。 ナレーターが以前は、このテキストを 2 回発表され、読み取り&quot; &amp; &quot;記号は、ユーザーに表示されない場合でも、実際のテキストとして。 重複するテキストがナレーターのお知らせから削除されるだけでなく不要な&quot; &amp; &quot;シンボル。</li><li><code>T:System.Windows.Forms.DataGridViewCell</code>正しくレポート ナレーターおよびその他の補助的なテクノロジを読み取り専用の状態がコントロールで型ようになりました。</li><li>ナレーターの子ウィンドウの [システム] メニューを読み取れるようになりました[マルチ ドキュメント インターフェイス](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md)アプリケーションです。</li><li>ナレーターは読み取れるようになりました<code>T:System.Windows.Forms.ToolStripMenuItem</code>と制御、<code>P:System.Windows.Forms.ToolStripItem.Enabled</code>プロパティに設定<em>false</em>です。 以前は、ナレーターは、内容を読み取るための無効なメニュー項目に重点を置くできませんでした。</li></ul>|
|スコープ|Major|
|Version|4.7.1|
|型|再ターゲット中|
|影響を受ける API|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[MonthCalendar.AccessibilityObject](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|


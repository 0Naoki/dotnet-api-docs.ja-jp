### <a name="currentculture-is-not-preserved-across-wpf-dispatcher-operations"></a><span data-ttu-id="6cc21-101">WPF ディスパッチャー操作 CurrentCulture は維持されません。</span><span class="sxs-lookup"><span data-stu-id="6cc21-101">CurrentCulture is not preserved across WPF Dispatcher operations</span></span>

|   |   |
|---|---|
|<span data-ttu-id="6cc21-102">説明</span><span class="sxs-lookup"><span data-stu-id="6cc21-102">Details</span></span>|<span data-ttu-id="6cc21-103">以降、.NET Framework 4.6 では、変更<xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name>または<xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name>内で行われた、<xref:System.Windows.Threading.Dispatcher?displayProperty=name>そのディスパッチャー操作の最後に失われます。</span><span class="sxs-lookup"><span data-stu-id="6cc21-103">Beginning in the .NET Framework 4.6, changes to <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> or <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> made within a <xref:System.Windows.Threading.Dispatcher?displayProperty=name> will be lost at the end of that dispatcher operation.</span></span> <span data-ttu-id="6cc21-104">同様に、<xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name>または<xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name>操作が反映されないときに操作が実行される、ディスパッチャーの外部で行われます。具体的に、つまり<xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name>と<xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name>WPF UI コールバックと WPF アプリケーションの他のコードの間での変更をフローせず可能性があります。これは、変更されたため、<xref:System.Threading.ExecutionContext?displayProperty=name>原因となった<xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name>と<xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name>.NET Framework 4.6 を対象とするアプリの実行コンテキストの先頭に格納されます。</span><span class="sxs-lookup"><span data-stu-id="6cc21-104">Similarly, changes to <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> or <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> made outside of a Dispatcher operation may not be reflected when that operation executes.Practically speaking, this means that <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> changes may not flow between WPF UI callbacks and other code in a WPF application.This is due to a change in <xref:System.Threading.ExecutionContext?displayProperty=name> that causes <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> to be stored in the execution context beginning with apps targeting the .NET Framework 4.6.</span></span> <span data-ttu-id="6cc21-105">WPF ディスパッチャー操作は、操作を開始するために使用された実行コンテキストを格納して、操作が完了したときに、以前のコンテキストを復元します。</span><span class="sxs-lookup"><span data-stu-id="6cc21-105">WPF dispatcher operations store the execution context used to begin the operation and restore the previous context when the operation is completed.</span></span> <span data-ttu-id="6cc21-106"><xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> と <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> がそのコンテキストの一部になったため、ディスパッチャー操作内でそれらに加えられた変更は、操作の外部では保持されません。</span><span class="sxs-lookup"><span data-stu-id="6cc21-106">Because <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> are now part of that context, changes to them within a dispatcher operation are not persisted outside of the operation.</span></span>|
|<span data-ttu-id="6cc21-107">提案される解決策</span><span class="sxs-lookup"><span data-stu-id="6cc21-107">Suggestion</span></span>|<span data-ttu-id="6cc21-108">この変更によって影響を受けるアプリは、必要な格納することを回避する可能性があります<xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name>または<xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name>フィールドおよびチェックインの (UI イベント コールバック ハンドラーを含む) のすべてのディスパッチャー操作ボディ内を正しい<xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name>と<xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name>設定されます。</span><span class="sxs-lookup"><span data-stu-id="6cc21-108">Apps affected by this change may work around it by storing the desired <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> or <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> in a field and checking in all Dispatcher operation bodies (including UI event callback handlers) that the correct <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> are set.</span></span> <span data-ttu-id="6cc21-109">また、ExecutionContext を変更する基になるためこの WPF 変更では、.NET Framework 4.6 以降を対象とするアプリのみに影響、この区切りを回避する .NET Framework 4.6 を対象または後で操作することも .NET Framework 4.5.2.Apps を対象とします。次の互換性を設定してこの問題を回避が切り替わります。</span><span class="sxs-lookup"><span data-stu-id="6cc21-109">Alternatively, because the ExecutionContext change underlying this WPF change only affects apps targeting the .NET Framework 4.6 or newer, this break can be avoided by targeting the .NET Framework 4.5.2.Apps that target .NET Framework 4.6 or later can also work around this by setting the following compatibility switch:</span></span><pre><code>AppContext.SetSwitch(&quot;Switch.System.Globalization.NoAsyncCurrentCulture&quot;, true);&#13;&#10;</code></pre><span data-ttu-id="6cc21-110">この問題は、.NET Framework 4.6.2 での WPF によって修正されました。</span><span class="sxs-lookup"><span data-stu-id="6cc21-110">This issue has been fixed by WPF in .NET Framework 4.6.2.</span></span> <span data-ttu-id="6cc21-111">.NET Frameworks 4.6、4.6.1 経由でも修正されました[KB 3139549](https://support.microsoft.com/kb/3139549)です。</span><span class="sxs-lookup"><span data-stu-id="6cc21-111">It has also been fixed in .NET Frameworks 4.6, 4.6.1 through [KB 3139549](https://support.microsoft.com/kb/3139549).</span></span> <span data-ttu-id="6cc21-112">.NET 4.6 以降を対象とするアプリケーションが、WPF アプリケーションで、右側の動作を自動的に表示します。 <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> / <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name>) ディスパッチャー操作間で保持されます。</span><span class="sxs-lookup"><span data-stu-id="6cc21-112">Applications targeting .NET 4.6 or later will automatically get the right behavior in WPF applications - <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name>/<xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name>) would be preserved across Dispatcher operations.</span></span>|
|<span data-ttu-id="6cc21-113">スコープ</span><span class="sxs-lookup"><span data-stu-id="6cc21-113">Scope</span></span>|<span data-ttu-id="6cc21-114">マイナー</span><span class="sxs-lookup"><span data-stu-id="6cc21-114">Minor</span></span>|
|<span data-ttu-id="6cc21-115">Version</span><span class="sxs-lookup"><span data-stu-id="6cc21-115">Version</span></span>|<span data-ttu-id="6cc21-116">4.6</span><span class="sxs-lookup"><span data-stu-id="6cc21-116">4.6</span></span>|
|<span data-ttu-id="6cc21-117">型</span><span class="sxs-lookup"><span data-stu-id="6cc21-117">Type</span></span>|<span data-ttu-id="6cc21-118">再ターゲット中</span><span class="sxs-lookup"><span data-stu-id="6cc21-118">Retargeting</span></span>|


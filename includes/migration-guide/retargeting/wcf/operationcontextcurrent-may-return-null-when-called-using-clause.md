### <a name="operationcontextcurrent-may-return-null-when-called-in-a-using-clause"></a>OperationContext.Current の返す可能性がありますを使用して、呼び出されたときに null 句

|   |   |
|---|---|
|説明|<xref:System.ServiceModel.OperationContext.Current?displayProperty=nameWithType> 返す可能性があります<code>null</code>と<xref:System.NullReferenceException>のすべての次の条件に該当する場合があります。<ul><li>値を取得する、<xref:System.ServiceModel.OperationContext.Current?displayProperty=nameWithType>プロパティを返すメソッドで、<xref:System.Threading.Tasks.Task>または<xref:System.Threading.Tasks.Task%601>です。</li><li>インスタンス化する、<xref:System.ServiceModel.OperationContextScope>内のオブジェクト、<code>using</code>句。</li><li>値を取得する、<xref:System.ServiceModel.OperationContext.Current?displayProperty=nameWithType>プロパティ内で、<code>using statement</code>です。 例:</li></ul><pre><code class="language-csharp">using (new OperationContextScope(OperationContext.Current))&#13;&#10;{&#13;&#10;OperationContext context = OperationContext.Current;      // OperationContext.Current is null.&#13;&#10;// ...&#13;&#10;}&#13;&#10;</code></pre>|
|提案される解決策|この問題に対処するには、次の操作を行うことができます。<ul><li>新しいのインスタンスを作成するには、次のように、コード変更ではない<code>null</code><xref:System.ServiceModel.OperationContext.Current%2A>オブジェクト。</li></ul><pre><code class="language-csharp">OperationContext ocx = OperationContext.Current;&#13;&#10;using (new OperationContextScope(OperationContext.Current))&#13;&#10;{&#13;&#10;OperationContext.Current = new OperationContext(ocx.Channel);&#13;&#10;// ...&#13;&#10;}&#13;&#10;</code></pre><ul><li>.NET framework 4.6.2、最新の更新プログラムをインストールまたは .NET Framework の以降のバージョンにアップグレードします。 フローが無効になります、<xref:System.Threading.ExecutionContext>で<xref:System.ServiceModel.OperationContext.Current?displayProperty=nameWithType>し、.NET Framework 4.6.1 および以前のバージョンの WCF アプリケーションの動作を復元します。 この動作は構成可能です。次のアプリケーション設定を構成ファイルに追加すると等価であります。</li></ul><pre><code class="language-xml">&lt;appSettings&gt;&#13;&#10;&lt;add key=&quot;Switch.System.ServiceModel.DisableOperationContextAsyncFlow&quot; value=&quot;true&quot; /&gt;&#13;&#10;&lt;/appSettings&gt;&#13;&#10;</code></pre>この変更が望ましくない場合、操作コンテキスト間を流れる実行コンテキストに依存するアプリケーションのフローを次のように有効にできます。<pre><code class="language-xml">&lt;appSettings&gt;&#13;&#10;&lt;add key=&quot;Switch.System.ServiceModel.DisableOperationContextAsyncFlow&quot; value=&quot;false&quot; /&gt;&#13;&#10;&lt;/appSettings&gt;&#13;&#10;</code></pre>|
|スコープ|エッジ|
|Version|4.6.2|
|型|再ターゲット中|
|影響を受ける API|<ul><li><xref:System.ServiceModel.OperationContext.Current?displayProperty=nameWithType></li></ul>|


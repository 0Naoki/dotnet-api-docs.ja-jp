### <a name="sslstream-supports-tls-alerts"></a><span data-ttu-id="34f45-101">SslStream は、TLS アラートをサポートしています</span><span class="sxs-lookup"><span data-stu-id="34f45-101">SslStream supports TLS Alerts</span></span>

|   |   |
|---|---|
|<span data-ttu-id="34f45-102">説明</span><span class="sxs-lookup"><span data-stu-id="34f45-102">Details</span></span>|<span data-ttu-id="34f45-103">失敗の TLS ハンドシェイクの後に、<xref:System.IO.IOException?displayProperty=name>内部で<xref:System.ComponentModel.Win32Exception?displayProperty=name>最初の I/O の読み取り/書き込み操作によって例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="34f45-103">After a failed TLS handshake, an <xref:System.IO.IOException?displayProperty=name> with an inner <xref:System.ComponentModel.Win32Exception?displayProperty=name> exception will be thrown by the first I/O Read/Write operation.</span></span> <span data-ttu-id="34f45-104"><xref:System.ComponentModel.Win32Exception.NativeErrorCode?displayProperty=name>のコードに、<xref:System.ComponentModel.Win32Exception?displayProperty=name>これを使用してリモート側の TLS アラートにマップすることができます[Schannel ドキュメント](https://msdn.microsoft.com/library/windows/desktop/dd721886%28v=vs.85%29.aspx)です。詳細については、次を参照してください[RFC 2246: 7.2.2 エラー アラート](https://tools.ietf.org/html/rfc2246#section-7.2.2).NET 4.6.2 および下の動作は、トランスポート チャネル (通常は TCP 接続) は、にタイムアウト書き込みまたは読み取り中に、その他のパーティが失敗した場合、。ハンドシェイクとすぐにその後、接続を拒否しました。</span><span class="sxs-lookup"><span data-stu-id="34f45-104">The <xref:System.ComponentModel.Win32Exception.NativeErrorCode?displayProperty=name> code for the <xref:System.ComponentModel.Win32Exception?displayProperty=name> can be mapped to the TLS Alert from the remote party using this [Schannel documentation](https://msdn.microsoft.com/library/windows/desktop/dd721886%28v=vs.85%29.aspx).For more information, see [RFC 2246: Section 7.2.2 Error alerts](https://tools.ietf.org/html/rfc2246#section-7.2.2)The behavior in .NET 4.6.2 and below is that the transport channel (usually TCP connection) will timeout during either Write or Read if the other party failed the handshake and immediately afterwards rejected the connection.</span></span>|
|<span data-ttu-id="34f45-105">提案される解決策</span><span class="sxs-lookup"><span data-stu-id="34f45-105">Suggestion</span></span>|<span data-ttu-id="34f45-106">呼び出すアプリケーション ネットワーク I/O Api のように<xref:System.IO.Stream.Read(System.Byte[],System.Int32,System.Int32)> / <xref:System.IO.Stream.Write(System.Byte[],System.Int32,System.Int32)>を処理する<xref:System.IO.IOException>または<xref:System.TimeoutException?displayProperty=name>です。既定の .NET 4.7 開始では、TLS アラート機能が有効にします。</span><span class="sxs-lookup"><span data-stu-id="34f45-106">Applications calling network I/O APIs such as <xref:System.IO.Stream.Read(System.Byte[],System.Int32,System.Int32)>/<xref:System.IO.Stream.Write(System.Byte[],System.Int32,System.Int32)> should handle <xref:System.IO.IOException> or <xref:System.TimeoutException?displayProperty=name>.The TLS Alerts feature is enabled by default starting with .NET 4.7.</span></span> <span data-ttu-id="34f45-107">.NET 4.0 の .NET 4.6.2 を対象とするアプリケーションの互換性を保持するために無効になっている機能が、.NET 4.7 または高いシステムで実行されています。次の構成 API は、有効または .NET 4.6 以降の .NET 4.7 または高い framework で実行されるアプリケーション、機能を無効に使用できます。</span><span class="sxs-lookup"><span data-stu-id="34f45-107">Applications targeting .NET 4.0 - .NET 4.6.2 running on a .NET 4.7 or higher system will have the feature disabled to preserve compatibility.The following configuration API is available to enable or disable the feature for .NET 4.6 and above applications running on .NET 4.7 or higher framework.</span></span><ul><li><span data-ttu-id="34f45-108">プログラムから。</span><span class="sxs-lookup"><span data-stu-id="34f45-108">Programmatically:</span></span></li></ul><span data-ttu-id="34f45-109">まず、アプリケーションは ServicePointManager は 1 回だけ初期化するためにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="34f45-109">Must be the very first thing the application does since ServicePointManager will initialize only once:</span></span><pre><code class="language-C#">AppContext.SetSwitch(&quot;TestSwitch.LocalAppContext.DisableCaching&quot;, true);&#13;&#10;AppContext.SetSwitch(&quot;Switch.System.Net.DontEnableTlsAlerts&quot;, true); // Set to &#39;false&#39; to enable the feature in .NET 4.6 - 4.6.2.&#13;&#10;</code></pre><ul><li><span data-ttu-id="34f45-110">AppConfig:</span><span class="sxs-lookup"><span data-stu-id="34f45-110">AppConfig:</span></span></li></ul><pre><code class="language-XML">&lt;runtime&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.System.Net.DontEnableTlsAlerts=true&quot;/&gt;&#13;&#10;&lt;!-- Set to &#39;false&#39; to enable the feature in .NET 4.6 - 4.6.2. --&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;</code></pre><ul><li><span data-ttu-id="34f45-111">レジストリ キー (グローバルのコンピューター):</span><span class="sxs-lookup"><span data-stu-id="34f45-111">Registry key (machine global):</span></span></li></ul><span data-ttu-id="34f45-112">.NET 4.6 - 4.6.2 で機能を有効にする 'false' に値を設定します。</span><span class="sxs-lookup"><span data-stu-id="34f45-112">Set the Value to 'false' to enable the feature in .NET 4.6 - 4.6.2.</span></span><pre><code>Key = HKLM\SOFTWARE\[Wow6432Node\]Microsoft\.NETFramework\AppContext\Switch.System.Net.DontEnableTlsAlerts&#13;&#10;Type = String&#13;&#10;Value = &quot;true&quot;&#13;&#10;</code></pre>|
|<span data-ttu-id="34f45-113">スコープ</span><span class="sxs-lookup"><span data-stu-id="34f45-113">Scope</span></span>|<span data-ttu-id="34f45-114">エッジ</span><span class="sxs-lookup"><span data-stu-id="34f45-114">Edge</span></span>|
|<span data-ttu-id="34f45-115">Version</span><span class="sxs-lookup"><span data-stu-id="34f45-115">Version</span></span>|<span data-ttu-id="34f45-116">4.7</span><span class="sxs-lookup"><span data-stu-id="34f45-116">4.7</span></span>|
|<span data-ttu-id="34f45-117">型</span><span class="sxs-lookup"><span data-stu-id="34f45-117">Type</span></span>|<span data-ttu-id="34f45-118">再ターゲット中</span><span class="sxs-lookup"><span data-stu-id="34f45-118">Retargeting</span></span>|
|<span data-ttu-id="34f45-119">影響を受ける API</span><span class="sxs-lookup"><span data-stu-id="34f45-119">Affected APIs</span></span>|<ul><li><xref:System.Net.Security.SslStream?displayProperty=nameWithType></li><li><xref:System.Net.WebRequest?displayProperty=nameWithType></li><li><xref:System.Net.HttpWebRequest?displayProperty=nameWithType></li><li><xref:System.Net.FtpWebRequest?displayProperty=nameWithType></li><li><xref:System.Net.Mail.SmtpClient?displayProperty=nameWithType></li><li><xref:System.Net.Http?displayProperty=nameWithType></li></ul>|


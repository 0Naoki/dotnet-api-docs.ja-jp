<Type Name="SqlDataSourceEnumerator" FullName="System.Data.Sql.SqlDataSourceEnumerator">
  <TypeSignature Language="C#" Value="public sealed class SqlDataSourceEnumerator : System.Data.Common.DbDataSourceEnumerator" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit SqlDataSourceEnumerator extends System.Data.Common.DbDataSourceEnumerator" />
  <TypeSignature Language="DocId" Value="T:System.Data.Sql.SqlDataSourceEnumerator" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class SqlDataSourceEnumerator&#xA;Inherits DbDataSourceEnumerator" />
  <TypeSignature Language="C++ CLI" Value="public ref class SqlDataSourceEnumerator sealed : System::Data::Common::DbDataSourceEnumerator" />
  <AssemblyInfo>
    <AssemblyName>System.Data</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Data.Common.DbDataSourceEnumerator</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="1f6c6-101">ローカル ネットワーク内で利用できる SQL Server のすべてのインスタンスを列挙する機構を提供します。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-101">Provides a mechanism for enumerating all available instances of SQL Server within the local network.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f6c6-102">SQL Server 2000 と SQL Server 2005 の両方では行うアプリケーションは現在のネットワーク内の SQL Server インスタンスの存在を確認します。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-102">Both SQL Server 2000 and SQL Server 2005 make it possible for applications to determine the existence of SQL Server instances within the current network.</span></span> <span data-ttu-id="1f6c6-103"><xref:System.Data.Sql.SqlDataSourceEnumerator>クラスを提供する、アプリケーションの開発者には、この情報を公開する、<xref:System.Data.DataTable>使用可能なすべてのサーバーに関する情報を格納します。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-103">The <xref:System.Data.Sql.SqlDataSourceEnumerator> class exposes this information to the application developer, providing a <xref:System.Data.DataTable> containing information about all the available servers.</span></span> <span data-ttu-id="1f6c6-104">これは、テーブルには、ユーザーが新しい接続を作成しようとしたときに指定されたリストに一致するサーバー インスタンスの一覧が含まれています。 返される、`Connection Properties`ダイアログ ボックスで、使用可能なすべてのサーバーを含むドロップダウン リストを展開します。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-104">This returned table contains a list of server instances that matches the list provided when a user attempts to create a new connection, and on the `Connection Properties` dialog box, expands the drop-down list containing all the available servers.</span></span>  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName="GetDataSources">
      <MemberSignature Language="C#" Value="public override System.Data.DataTable GetDataSources ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Data.DataTable GetDataSources() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.Sql.SqlDataSourceEnumerator.GetDataSources" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetDataSources () As DataTable" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Data::DataTable ^ GetDataSources();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.DataTable</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="1f6c6-105">参照できるすべての SQL Server 2000 インスタンスまたは SQL Server 2005 インスタンスに関する情報が格納された <see cref="T:System.Data.DataTable" /> を取得します。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-105">Retrieves a <see cref="T:System.Data.DataTable" /> containing information about all visible SQL Server 2000 or SQL Server 2005 instances.</span></span></summary>
        <returns><span data-ttu-id="1f6c6-106">参照できる SQL Server のインスタンスに関する情報が格納された <see cref="T:System.Data.DataTable" /> を返します。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-106">Returns a <see cref="T:System.Data.DataTable" /> containing information about the visible SQL Server instances.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f6c6-107">このメソッドによって返されるテーブルには、次の列が含まれています。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-107">The table returned by this method contains the following columns, all of which contain strings:</span></span>  
  
|<span data-ttu-id="1f6c6-108">Column</span><span class="sxs-lookup"><span data-stu-id="1f6c6-108">Column</span></span>|<span data-ttu-id="1f6c6-109">説明</span><span class="sxs-lookup"><span data-stu-id="1f6c6-109">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="1f6c6-110">**ServerName**</span><span class="sxs-lookup"><span data-stu-id="1f6c6-110">**ServerName**</span></span>|<span data-ttu-id="1f6c6-111">サーバーの名前。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-111">Name of the server.</span></span>|  
|<span data-ttu-id="1f6c6-112">**InstanceName**</span><span class="sxs-lookup"><span data-stu-id="1f6c6-112">**InstanceName**</span></span>|<span data-ttu-id="1f6c6-113">サーバー インスタンスの名前。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-113">Name of the server instance.</span></span> <span data-ttu-id="1f6c6-114">サーバーが既定のインスタンスとして実行されている場合は空白になります。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-114">Blank if the server is running as the default instance.</span></span>|  
|<span data-ttu-id="1f6c6-115">**IsClustered**</span><span class="sxs-lookup"><span data-stu-id="1f6c6-115">**IsClustered**</span></span>|<span data-ttu-id="1f6c6-116">サーバーがクラスターの一部になっているかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-116">Indicates whether the server is part of a cluster.</span></span>|  
|<span data-ttu-id="1f6c6-117">**Version**</span><span class="sxs-lookup"><span data-stu-id="1f6c6-117">**Version**</span></span>|<span data-ttu-id="1f6c6-118">サーバーのバージョン (SQL Server 2000 の場合は 8.00.x、SQL Server 2005 の場合は 9.00.x)。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-118">Version of the server (8.00.x for SQL Server 2000, and 9.00.x for SQL Server 2005).</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="1f6c6-119">メカニズムを使用しての性質の<xref:System.Data.Sql.SqlDataSourceEnumerator>をネットワーク上のデータ ソースを検索するには、メソッドは常に返されません、使用可能なサーバーの完全な一覧と同じすべての呼び出しで、一覧とは限りません。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-119">Due to the nature of the mechanism used by <xref:System.Data.Sql.SqlDataSourceEnumerator> to locate data sources on a network, the method will not always return a complete list of the available servers, and the list might not be the same on every call.</span></span> <span data-ttu-id="1f6c6-120">関数を使用してこのユーザーの一覧からサーバーを選択できるようにする場合は、常にもサーバーの列挙が使用可能なすべてのサーバーを返さない場合に、一覧に含まれていない名前を入力するためのオプションを指定することを確認します。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-120">If you plan to use this function to let users select a server from a list, make sure that you always also supply an option to type in a name that is not in the list, in case the server enumeration does not return all the available servers.</span></span> <span data-ttu-id="1f6c6-121">さらに、このメソッドには、かなりの実行、パフォーマンスが重要な呼び出しについては注意が必要に時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-121">In addition, this method may take a significant amount of time to execute, so be careful about calling it when performance is critical.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f6c6-122">次のコンソール アプリケーションでは、表示されているすべての SQL Server インスタンスに関する情報を取得し、コンソール ウィンドウに情報を表示します。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-122">The following console application retrieves information about all the visible SQL Server instances and displays the information in the console window.</span></span>  
  
```vb  
Imports System.Data.Sql  
  
Module Module1  
  Sub Main()  
    ' Retrieve the enumerator instance and then the data.  
    Dim instance As SqlDataSourceEnumerator = _  
     SqlDataSourceEnumerator.Instance  
    Dim table As System.Data.DataTable = instance.GetDataSources()  
  
    ' Display the contents of the table.  
    DisplayData(table)  
  
    Console.WriteLine("Press any key to continue.")  
    Console.ReadKey()  
  End Sub  
  
  Private Sub DisplayData(ByVal table As DataTable)  
    For Each row As DataRow In table.Rows  
      For Each col As DataColumn In table.Columns  
        Console.WriteLine("{0} = {1}", col.ColumnName, row(col))  
      Next  
      Console.WriteLine("============================")  
    Next  
  End Sub  
End Module  
```  
  
```csharp  
using System.Data.Sql;  
  
class Program  
{  
  static void Main()  
  {  
    // Retrieve the enumerator instance and then the data.  
    SqlDataSourceEnumerator instance =  
      SqlDataSourceEnumerator.Instance;  
    System.Data.DataTable table = instance.GetDataSources();  
  
    // Display the contents of the table.  
    DisplayData(table);  
  
    Console.WriteLine("Press any key to continue.");  
    Console.ReadKey();  
  }  
  
  private static void DisplayData(System.Data.DataTable table)  
  {  
    foreach (System.Data.DataRow row in table.Rows)  
    {  
      foreach (System.Data.DataColumn col in table.Columns)  
      {  
        Console.WriteLine("{0} = {1}", col.ColumnName, row[col]);  
      }  
      Console.WriteLine("============================");  
    }  
  }  
}  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Instance">
      <MemberSignature Language="C#" Value="public static System.Data.Sql.SqlDataSourceEnumerator Instance { get; }" />
      <MemberSignature Language="ILAsm" Value=".property class System.Data.Sql.SqlDataSourceEnumerator Instance" />
      <MemberSignature Language="DocId" Value="P:System.Data.Sql.SqlDataSourceEnumerator.Instance" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property Instance As SqlDataSourceEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::Data::Sql::SqlDataSourceEnumerator ^ Instance { System::Data::Sql::SqlDataSourceEnumerator ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.Sql.SqlDataSourceEnumerator</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="1f6c6-123">利用できる SQL Server のインスタンスに関する情報を取得するために使用できる <see cref="T:System.Data.Sql.SqlDataSourceEnumerator" /> のインスタンスを取得します。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-123">Gets an instance of the <see cref="T:System.Data.Sql.SqlDataSourceEnumerator" />, which can be used to retrieve information about available SQL Server instances.</span></span></summary>
        <value><span data-ttu-id="1f6c6-124">利用できる SQL Server のインスタンスに関する情報を取得するために使用される <see cref="T:System.Data.Sql.SqlDataSourceEnumerator" /> のインスタンス。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-124">An instance of the <see cref="T:System.Data.Sql.SqlDataSourceEnumerator" /> used to retrieve information about available SQL Server instances.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1f6c6-125"><xref:System.Data.Sql.SqlDataSourceEnumerator>クラスは、コンス トラクターを提供しません。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-125">The <xref:System.Data.Sql.SqlDataSourceEnumerator> class does not provide a constructor.</span></span> <span data-ttu-id="1f6c6-126">使用して、<xref:System.Data.Sql.SqlDataSourceEnumerator.Instance%2A>代わりに、クラスのインスタンスを取得するプロパティです。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-126">Use the <xref:System.Data.Sql.SqlDataSourceEnumerator.Instance%2A> property to retrieve an instance of the class instead.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="1f6c6-127">次のコンソール アプリケーションには、ローカル ネットワーク内で使用可能なすべての SQL Server 2005 インスタンスの一覧が表示されます。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-127">The following console application displays a list of all the available SQL Server 2005 instances within the local network.</span></span> <span data-ttu-id="1f6c6-128">このコードを使用して、<xref:System.Data.DataTable.Select%2A>をによって返されるテーブル内の行をフィルター処理するメソッド、<xref:System.Data.Sql.SqlDataSourceEnumerator.GetDataSources%2A>メソッドです。</span><span class="sxs-lookup"><span data-stu-id="1f6c6-128">This code uses the <xref:System.Data.DataTable.Select%2A> method to filter the rows in the table returned by the <xref:System.Data.Sql.SqlDataSourceEnumerator.GetDataSources%2A> method.</span></span>  
  
```vb  
Imports System.Data.Sql  
  
Module Module1  
  Sub Main()  
    ' Retrieve the enumerator instance, and  
    ' then retrieve the data sources.  
    Dim instance As SqlDataSourceEnumerator = _  
     SqlDataSourceEnumerator.Instance  
    Dim table As System.Data.DataTable = instance.GetDataSources()  
  
    ' Filter the sources to just show SQL Server 2005 instances.  
    Dim rows() As DataRow = table.Select("Version LIKE '9%'")  
    For Each row As DataRow In rows  
      Console.WriteLine(row("ServerName"))  
    Next  
    Console.WriteLine("Press any key to continue.")  
    Console.ReadKey()  
  End Sub  
End Module  
```  
  
```csharp  
using System.Data.Sql;  
  
class Program  
{  
  static void Main()  
  {  
    // Retrieve the enumerator instance, and  
    // then retrieve the data sources.  
    SqlDataSourceEnumerator instance =  
      SqlDataSourceEnumerator.Instance;  
    System.Data.DataTable table = instance.GetDataSources();  
  
    // Filter the sources to just show SQL Server 2005 instances.  
    System.Data.DataRow[] rows = table.Select("Version LIKE '9%'");  
    foreach (System.Data.DataRow row in rows)  
    {  
      Console.WriteLine(row["ServerName"]);  
    }  
    Console.WriteLine("Press any key to continue.");  
    Console.ReadKey();  
  }  
}  
```  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>
<Type Name="ListViewInsertionMark" FullName="System.Windows.Forms.ListViewInsertionMark">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="2e7383a0bdc59f7b3f55dd5bd6162c3f0cd7390c" />
    <Meta Name="ms.sourcegitcommit" Value="5a49536d99d2d0b54e4cb7280870903e043272df" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="ja-JP" />
    <Meta Name="ms.lasthandoff" Value="07/03/2018" />
    <Meta Name="ms.locfileid" Value="37509998" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class ListViewInsertionMark" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit ListViewInsertionMark extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Windows.Forms.ListViewInsertionMark" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class ListViewInsertionMark" />
  <TypeSignature Language="C++ CLI" Value="public ref class ListViewInsertionMark sealed" />
  <TypeSignature Language="F#" Value="type ListViewInsertionMark = class" />
  <AssemblyInfo>
    <AssemblyName>System.Windows.Forms</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="c99b4-101">
        <see cref="T:System.Windows.Forms.ListView" /> コントロールで項目を新しい位置にドラッグしたときに、ドロップの予定位置を示すために使用されます。</span>
      <span class="sxs-lookup">
        <span data-stu-id="c99b4-101">Used to indicate the expected drop location when an item is dragged to a new position in a <see cref="T:System.Windows.Forms.ListView" /> control.</span>
      </span>
      <span data-ttu-id="c99b4-102">この機能は、Windows XP 以降のみで使用できます。</span>
      <span class="sxs-lookup">
        <span data-stu-id="c99b4-102">This functionality is available only on Windows XP and later.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c99b4-103">取得することができます、<xref:System.Windows.Forms.ListViewInsertionMark>から、<xref:System.Windows.Forms.ListView.InsertionMark%2A>のプロパティを<xref:System.Windows.Forms.ListView>制御を使用して新しい位置に項目がドラッグされるときに、ドラッグ アンド ドロップ操作で目的のドロップ位置を視覚的に示します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-103">You can retrieve a <xref:System.Windows.Forms.ListViewInsertionMark> from the <xref:System.Windows.Forms.ListView.InsertionMark%2A> property of a <xref:System.Windows.Forms.ListView> control and use it to visually indicate the expected drop location in a drag-and-drop operation when an item is dragged to a new position.</span></span>  
  
 <span data-ttu-id="c99b4-104">この機能は場合にのみ、<xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=nameWithType>プロパティに設定されて`true`とタイミング、<xref:System.Windows.Forms.ListView>コントロールが項目を自動的に並べ替えられません。</span><span class="sxs-lookup"><span data-stu-id="c99b4-104">This feature works only when the <xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=nameWithType> property is set to `true` and when the <xref:System.Windows.Forms.ListView> control does not sort the items automatically.</span></span> <span data-ttu-id="c99b4-105">自動並べ替えを防ぐために、<xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=nameWithType>にプロパティを設定する必要があります<xref:System.Windows.Forms.SortOrder.None?displayProperty=nameWithType>と<xref:System.Windows.Forms.ListView.View%2A?displayProperty=nameWithType>にプロパティを設定する必要があります<xref:System.Windows.Forms.View.LargeIcon?displayProperty=nameWithType>、 <xref:System.Windows.Forms.View.SmallIcon?displayProperty=nameWithType>、または<xref:System.Windows.Forms.View.Tile?displayProperty=nameWithType>します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-105">To prevent automatic sorting, the <xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=nameWithType> property must be set to <xref:System.Windows.Forms.SortOrder.None?displayProperty=nameWithType> and the <xref:System.Windows.Forms.ListView.View%2A?displayProperty=nameWithType> property must be set to <xref:System.Windows.Forms.View.LargeIcon?displayProperty=nameWithType>, <xref:System.Windows.Forms.View.SmallIcon?displayProperty=nameWithType>, or <xref:System.Windows.Forms.View.Tile?displayProperty=nameWithType>.</span></span> <span data-ttu-id="c99b4-106">さらに、挿入マーク機能は使用できません、<xref:System.Windows.Forms.ListView>のグループ化機能グループのメンバーシップによって、項目を注文するための機能をグループ化します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-106">Additionally, the insertion mark feature cannot be used with the <xref:System.Windows.Forms.ListView> grouping feature because the grouping feature orders the items by group membership.</span></span>  
  
 <span data-ttu-id="c99b4-107"><xref:System.Windows.Forms.ListViewInsertionMark>クラスは通常のハンドラーで使用、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>または<xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType>項目がドラッグされると、挿入マークの位置を更新するイベントです。</span><span class="sxs-lookup"><span data-stu-id="c99b4-107">The <xref:System.Windows.Forms.ListViewInsertionMark> class is typically used in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType> event to update the position of the insertion mark as an item is dragged.</span></span> <span data-ttu-id="c99b4-108">ハンドラーで使用されても、<xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType>または<xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType>の正しい場所にドラッグした項目を挿入するイベントです。</span><span class="sxs-lookup"><span data-stu-id="c99b4-108">It is also used in a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType> event to insert a dragged item at the correct location.</span></span>  
  
 <span data-ttu-id="c99b4-109">挿入マークの位置を更新するには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-109">To update the position of the insertion mark, follow these steps:</span></span>  
  
1.  <span data-ttu-id="c99b4-110">ハンドラーで、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>または<xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType>イベントを使用して、<xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=nameWithType>プロパティにアクセスする、<xref:System.Windows.Forms.ListViewInsertionMark>オブジェクトに関連付けられている、<xref:System.Windows.Forms.ListView>コントロール。</span><span class="sxs-lookup"><span data-stu-id="c99b4-110">In a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType> event, use the <xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=nameWithType> property to access the <xref:System.Windows.Forms.ListViewInsertionMark> object associated with the <xref:System.Windows.Forms.ListView> control.</span></span>  
  
2.  <span data-ttu-id="c99b4-111">使用して、<xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>マウス ポインターに最も近い項目のインデックスを取得します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-111">Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer.</span></span>  
  
3.  <span data-ttu-id="c99b4-112">インデックス値を渡す、<xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType>項目の外接する四角形を取得します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-112">Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType> method to retrieve the bounding rectangle of the item.</span></span>  
  
4.  <span data-ttu-id="c99b4-113">外接する四角形の中心の左側にマウス ポインターがある場合は、設定、<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>プロパティを`false`。 それ以外に設定`true`します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-113">If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property to `false`; otherwise, set it to `true`.</span></span>  
  
5.  <span data-ttu-id="c99b4-114">設定、<xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>プロパティから取得したインデックス値を<xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>メソッド。</span><span class="sxs-lookup"><span data-stu-id="c99b4-114">Set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to the index value retrieved from the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method.</span></span> <span data-ttu-id="c99b4-115">挿入マークを左側または右側で、に応じていずれかの指定のインデックスを持つアイテムの横に表示、<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>プロパティの値。</span><span class="sxs-lookup"><span data-stu-id="c99b4-115">The insertion mark appears next to item with the specified index, either to the left or the right, depending on the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property value.</span></span> <span data-ttu-id="c99b4-116">インデックス自体の上の項目をドラッグするが-1 の場合、この挿入マークは表示されません。</span><span class="sxs-lookup"><span data-stu-id="c99b4-116">If an item is dragged over itself, the index is -1 and the insertion mark is hidden.</span></span>  
  
 <span data-ttu-id="c99b4-117">正しい場所にドラッグした項目を挿入するには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-117">To insert the dragged item at the correct location, follow these steps:</span></span>  
  
1.  <span data-ttu-id="c99b4-118">ハンドラーで、<xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType>または<xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType>イベントを使用して、<xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>挿入マークの現在の場所を決定するプロパティ。</span><span class="sxs-lookup"><span data-stu-id="c99b4-118">In a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType> event, use the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to determine the current location of the insertion mark.</span></span> <span data-ttu-id="c99b4-119">挿入のインデックスとして後で使用するには、この値を格納します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-119">Store this value to be used later as the insertion index.</span></span>  
  
2.  <span data-ttu-id="c99b4-120">場合、<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>プロパティに設定されて`true`、挿入ストアドのインデックス値をインクリメントします。</span><span class="sxs-lookup"><span data-stu-id="c99b4-120">If the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `true`, increment the stored insertion index value.</span></span>  
  
3.  <span data-ttu-id="c99b4-121">使用して、<xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=nameWithType>にドラッグした項目の複製を挿入するメソッドを<xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType>ストアド挿入インデックス位置にあるコレクション。</span><span class="sxs-lookup"><span data-stu-id="c99b4-121">Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=nameWithType> method to insert a clone of the dragged item into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> collection at the stored insertion index.</span></span>  
  
4.  <span data-ttu-id="c99b4-122">使用して、<xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=nameWithType>ドラッグした項目の元のコピーを削除する方法。</span><span class="sxs-lookup"><span data-stu-id="c99b4-122">Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=nameWithType> method to remove the original copy of the dragged item.</span></span>  
  
 <span data-ttu-id="c99b4-123">インデックス値であるために、元のコピーが削除される前に、ドラッグした項目の複製を挿入する必要があります、<xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType>コレクションは、挿入前に変更されません。</span><span class="sxs-lookup"><span data-stu-id="c99b4-123">You must insert a clone of the dragged item before the original copy is removed so the index values in the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> collection are not altered before the insertion.</span></span>  
  
 <span data-ttu-id="c99b4-124">設定する必要があります、インデックスの値と同じ順序で項目が表示されることを確認する、<xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=nameWithType>プロパティの実装を<xref:System.Collections.IComparer>をインデックス値によって項目を並べ替えるためのインターフェイス。</span><span class="sxs-lookup"><span data-stu-id="c99b4-124">To ensure that the items are displayed in the same order as their index values, you must set the <xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=nameWithType> property to an implementation of the <xref:System.Collections.IComparer> interface that sorts items by index value.</span></span> <span data-ttu-id="c99b4-125">詳細については、「使用例」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c99b4-125">For more information, see the Example section.</span></span>  
  
 <span data-ttu-id="c99b4-126">使用して挿入マークの色を変更できる、<xref:System.Windows.Forms.ListViewInsertionMark.Color%2A>プロパティ。</span><span class="sxs-lookup"><span data-stu-id="c99b4-126">You can modify the color of the insertion mark by using the <xref:System.Windows.Forms.ListViewInsertionMark.Color%2A> property.</span></span> <span data-ttu-id="c99b4-127">サイズまたは挿入マークの位置が必要な場合、外接する四角形を入手できる、<xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A>プロパティ。</span><span class="sxs-lookup"><span data-stu-id="c99b4-127">If you need the size or position of the insertion mark, you can get its bounding rectangle through the <xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A> property.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c99b4-128">挿入マーク機能は Windows XP および Windows Server 2003 ファミリでのみ使用できますが、アプリケーションを呼び出すと、<xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType>メソッド。</span><span class="sxs-lookup"><span data-stu-id="c99b4-128">The insertion mark feature is available only on Windows XP and the Windows Server 2003 family when your application calls the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="c99b4-129">以前のオペレーティング システムでは、挿入マークに関連するすべてのコードは無視され、挿入マークは表示されません。</span><span class="sxs-lookup"><span data-stu-id="c99b4-129">On earlier operating systems, any code relating to the insertion mark will be ignored and the insertion mark will not appear.</span></span> <span data-ttu-id="c99b4-130">その結果、挿入マーク機能に依存する任意のコードが正しく動作しない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c99b4-130">As a result, any code that depends on the insertion mark feature may not work correctly.</span></span> <span data-ttu-id="c99b4-131">挿入マーク機能は、使用できるかどうかを決定するテストを含めるし、が利用できない場合は、代替機能を提供する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c99b4-131">You may want to include a test that determines whether the insertion mark feature is available, and provide alternate functionality when it is unavailable.</span></span> <span data-ttu-id="c99b4-132">たとえば、挿入マークをサポートしないオペレーティング システムで実行されているときの位置を変更する項目のドラッグ アンド ドロップを実装するすべてのコードをバイパスすることがあります。</span><span class="sxs-lookup"><span data-stu-id="c99b4-132">For example, you may want to bypass all code that implements drag-and-drop item repositioning when running on operating systems that do not support insertion marks.</span></span>  
>   
>  <span data-ttu-id="c99b4-133">挿入マーク機能は、オペレーティング システムのテーマ機能を提供するのと同じライブラリによって提供されます。</span><span class="sxs-lookup"><span data-stu-id="c99b4-133">The insertion mark feature is provided by the same library that provides the operating system themes feature.</span></span> <span data-ttu-id="c99b4-134">このライブラリの可用性を確認するには、呼び出し、<xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=nameWithType>メソッドのオーバー ロードを渡します、<xref:System.Windows.Forms.OSFeature.Themes?displayProperty=nameWithType>値。</span><span class="sxs-lookup"><span data-stu-id="c99b4-134">To check for the availability of this library, call the <xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=nameWithType> method overload and pass in the <xref:System.Windows.Forms.OSFeature.Themes?displayProperty=nameWithType> value.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c99b4-135">次のコード例は、使用する方法を示します、<xref:System.Windows.Forms.ListView>挿入マーク機能および実装するドラッグ アンド ドロップの項目の並べ替えが標準を使用してイベントをドラッグします。</span><span class="sxs-lookup"><span data-stu-id="c99b4-135">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="c99b4-136">挿入マークの位置は、イベントのハンドラーで更新、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>イベント。</span><span class="sxs-lookup"><span data-stu-id="c99b4-136">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="c99b4-137">このハンドラーで、最も近い項目の中間点にマウス ポインターの位置を比較し、結果を使用して、アイテムの左右に挿入マークを表示するかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-137">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#1)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#1)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Windows.Forms.ListView" />
  </Docs>
  <Members>
    <Member MemberName="AppearsAfterItem">
      <MemberSignature Language="C#" Value="public bool AppearsAfterItem { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool AppearsAfterItem" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem" />
      <MemberSignature Language="VB.NET" Value="Public Property AppearsAfterItem As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool AppearsAfterItem { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.AppearsAfterItem : bool with get, set" Usage="System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c99b4-138">
            <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" /> プロパティによって指定されたインデックスを持つ項目の右側に挿入マークを表示するかどうかを示す値を取得または設定します。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-138">Gets or sets a value indicating whether the insertion mark appears to the right of the item with the index specified by the <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" /> property.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c99b4-139">
            <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" /> プロパティによって指定されたインデックスを持つ項目の右側に挿入マークを表示する場合は <see langword="true" />。それ以外の場合は <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-139">
              <see langword="true" /> if the insertion mark appears to the right of the item with the index specified by the <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" /> property; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="c99b4-140">既定値は、<see langword="false" /> です。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-140">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c99b4-141"><xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>メソッドを使用して、マウスのポインターに最も近い項目を検索できますが前に、またはこの項目の後に挿入マークを表示する必要があるかどうかを決定する、独自の計算を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="c99b4-141">The <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method lets you find the item closest to the mouse pointer, but you must do your own calculations to determine whether the insertion mark should appear before or after this item.</span></span>  
  
 <span data-ttu-id="c99b4-142">必要な値を計算する、<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>プロパティ、これらの手順に従います。</span><span class="sxs-lookup"><span data-stu-id="c99b4-142">To calculate the value needed for the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property, follow these steps:</span></span>  
  
1.  <span data-ttu-id="c99b4-143">使用して、<xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>マウス ポインターに最も近い項目のインデックスを取得します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-143">Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer.</span></span>  
  
2.  <span data-ttu-id="c99b4-144">インデックス値を渡す、<xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType>項目の外接する四角形を取得します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-144">Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType> method to retrieve the bounding rectangle of the item.</span></span>  
  
3.  <span data-ttu-id="c99b4-145">外接する四角形の中心の左側にマウス ポインターがある場合は、設定、<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>プロパティを`false`。 それ以外に設定`true`します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-145">If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property to `false`; otherwise, set it to `true`.</span></span>  
  
 <span data-ttu-id="c99b4-146">詳細については、次を参照してください。、<xref:System.Windows.Forms.ListViewInsertionMark>概要リファレンス トピック。</span><span class="sxs-lookup"><span data-stu-id="c99b4-146">For more information, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c99b4-147">次のコード例は、使用する方法を示します、<xref:System.Windows.Forms.ListView>挿入マーク機能および実装するドラッグ アンド ドロップの項目の並べ替えが標準を使用してイベントをドラッグします。</span><span class="sxs-lookup"><span data-stu-id="c99b4-147">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="c99b4-148">挿入マークの位置は、イベントのハンドラーで更新、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>イベント。</span><span class="sxs-lookup"><span data-stu-id="c99b4-148">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="c99b4-149">このハンドラーで、最も近い項目の中間点にマウス ポインターの位置を比較し、結果を使用して、アイテムの左右に挿入マークを表示するかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-149">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 <span data-ttu-id="c99b4-150">完全な例では、次を参照してください。、<xref:System.Windows.Forms.ListViewInsertionMark>概要リファレンス トピック。</span><span class="sxs-lookup"><span data-stu-id="c99b4-150">For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="Bounds">
      <MemberSignature Language="C#" Value="public System.Drawing.Rectangle Bounds { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Drawing.Rectangle Bounds" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Bounds" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Bounds As Rectangle" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Drawing::Rectangle Bounds { System::Drawing::Rectangle get(); };" />
      <MemberSignature Language="F#" Value="member this.Bounds : System.Drawing.Rectangle" Usage="System.Windows.Forms.ListViewInsertionMark.Bounds" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Drawing.Rectangle</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c99b4-151">挿入マークに外接する四角形を取得します。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-151">Gets the bounding rectangle of the insertion mark.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c99b4-152">挿入マークの位置とサイズを表す <see cref="T:System.Drawing.Rectangle" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-152">A <see cref="T:System.Drawing.Rectangle" /> that represents the position and size of the insertion mark.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c99b4-153">左上隅に対して相対的の外接する四角形の挿入マークの座標は、<xref:System.Windows.Forms.ListView>コントロール。</span><span class="sxs-lookup"><span data-stu-id="c99b4-153">The coordinates in the insertion mark bounding rectangle are relative to the upper-left corner of the <xref:System.Windows.Forms.ListView> control.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="Color">
      <MemberSignature Language="C#" Value="public System.Drawing.Color Color { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Drawing.Color Color" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Color" />
      <MemberSignature Language="VB.NET" Value="Public Property Color As Color" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Drawing::Color Color { System::Drawing::Color get(); void set(System::Drawing::Color value); };" />
      <MemberSignature Language="F#" Value="member this.Color : System.Drawing.Color with get, set" Usage="System.Windows.Forms.ListViewInsertionMark.Color" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Drawing.Color</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c99b4-154">挿入マークの色を取得または設定します。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-154">Gets or sets the color of the insertion mark.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c99b4-155">挿入マークの色を表す <see cref="T:System.Drawing.Color" /> 値。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-155">A <see cref="T:System.Drawing.Color" /> value that represents the color of the insertion mark.</span>
          </span>
          <span data-ttu-id="c99b4-156">既定値は <see cref="P:System.Windows.Forms.ListView.ForeColor" /> プロパティの値です。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-156">The default value is the value of the <see cref="P:System.Windows.Forms.ListView.ForeColor" /> property.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c99b4-157">このプロパティの前景色以外の値に挿入マークの色の設定を使用して、<xref:System.Windows.Forms.ListView>コントロール。</span><span class="sxs-lookup"><span data-stu-id="c99b4-157">Use this property to set the insertion mark color to a value other than the foreground color of the <xref:System.Windows.Forms.ListView> control.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c99b4-158">次のコード例は、使用する方法を示します、<xref:System.Windows.Forms.ListView>挿入マーク機能および実装するドラッグ アンド ドロップの項目の並べ替えが標準を使用してイベントをドラッグします。</span><span class="sxs-lookup"><span data-stu-id="c99b4-158">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="c99b4-159">挿入マークの位置は、イベントのハンドラーで更新、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>イベント。</span><span class="sxs-lookup"><span data-stu-id="c99b4-159">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="c99b4-160">このハンドラーで、最も近い項目の中間点にマウス ポインターの位置を比較し、結果を使用して、アイテムの左右に挿入マークを表示するかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-160">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 <span data-ttu-id="c99b4-161">完全な例では、次を参照してください。、<xref:System.Windows.Forms.ListViewInsertionMark>概要リファレンス トピック。</span><span class="sxs-lookup"><span data-stu-id="c99b4-161">For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#2)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#2)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="Index">
      <MemberSignature Language="C#" Value="public int Index { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 Index" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Index" />
      <MemberSignature Language="VB.NET" Value="Public Property Index As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int Index { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.Index : int with get, set" Usage="System.Windows.Forms.ListViewInsertionMark.Index" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c99b4-162">挿入マークが表示される位置の横にある項目のインデックスを取得または設定します。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-162">Gets or sets the index of the item next to which the insertion mark appears.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c99b4-163">挿入マークが表示される位置の横にある項目のインデックス。挿入マークが非表示の時には、-1 が返されます。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-163">The index of the item next to which the insertion mark appears or -1 when the insertion mark is hidden.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c99b4-164">場合に、指定したインデックスを持つ項目の左側に挿入マークが表示されます、<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>プロパティに設定されて`false`、それ以外のアイテムの右側に表示されます。</span><span class="sxs-lookup"><span data-stu-id="c99b4-164">The insertion mark appears to the left of the item with the specified index if the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `false`; otherwise, it appears to the right of the item.</span></span> <span data-ttu-id="c99b4-165">ドラッグした項目が挿入されると、挿入マークは自動的に表示されなくなります、<xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType>コレクション。</span><span class="sxs-lookup"><span data-stu-id="c99b4-165">The insertion mark disappears automatically when a dragged item is inserted into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="c99b4-166">挿入マークは、手動で削除する、たとえば、項目が自体をドラッグまたはコントロールの外側にドラッグしたときに、設定、<xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>値を-1 にします。</span><span class="sxs-lookup"><span data-stu-id="c99b4-166">To remove the insertion mark manually, for example, when an item is dragged onto itself or dragged outside the control, set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> value to -1.</span></span>  
  
 <span data-ttu-id="c99b4-167">使用して、<xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>ドラッグ アンド ドロップ操作でのアイテムの配置時にマウス ポインターの場所などの指定した場所に最も近い項目のインデックスを取得します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-167">Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to a specified location, such as the location of the mouse pointer when positioning an item in a drag-and-drop operation.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c99b4-168">次のコード例は、使用する方法を示します、<xref:System.Windows.Forms.ListView>挿入マーク機能および実装するドラッグ アンド ドロップの項目の並べ替えが標準を使用してイベントをドラッグします。</span><span class="sxs-lookup"><span data-stu-id="c99b4-168">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="c99b4-169">挿入マークの位置は、イベントのハンドラーで更新、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>イベント。</span><span class="sxs-lookup"><span data-stu-id="c99b4-169">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="c99b4-170">このハンドラーで、最も近い項目の中間点にマウス ポインターの位置を比較し、結果を使用して、アイテムの左右に挿入マークを表示するかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-170">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 <span data-ttu-id="c99b4-171">完全な例では、次を参照してください。、<xref:System.Windows.Forms.ListViewInsertionMark>概要リファレンス トピック。</span><span class="sxs-lookup"><span data-stu-id="c99b4-171">For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="NearestIndex">
      <MemberSignature Language="C#" Value="public int NearestIndex (System.Drawing.Point pt);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance int32 NearestIndex(valuetype System.Drawing.Point pt) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.ListViewInsertionMark.NearestIndex(System.Drawing.Point)" />
      <MemberSignature Language="VB.NET" Value="Public Function NearestIndex (pt As Point) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; int NearestIndex(System::Drawing::Point pt);" />
      <MemberSignature Language="F#" Value="member this.NearestIndex : System.Drawing.Point -&gt; int" Usage="listViewInsertionMark.NearestIndex pt" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pt" Type="System.Drawing.Point" />
      </Parameters>
      <Docs>
        <param name="pt">
          <span data-ttu-id="c99b4-172">最も近い項目を探すときの起点を表す <see cref="T:System.Drawing.Point" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-172">A <see cref="T:System.Drawing.Point" /> representing the location from which to find the nearest item.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c99b4-173">指定した位置に最も近い項目のインデックスを取得します。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-173">Retrieves the index of the item closest to the specified point.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="c99b4-174">指定された位置に最も近い項目のインデックス。最も近い項目が、現在ドラッグしている項目である場合は、-1 が返されます。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c99b4-174">The index of the item closest to the specified point or -1 if the closest item is the item currently being dragged.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c99b4-175">このメソッドでは、ドラッグ アンド ドロップ操作を実施する際に、マウス ポインターに最も近い項目を検索できます。</span><span class="sxs-lookup"><span data-stu-id="c99b4-175">This method lets you locate the item closest to the mouse pointer when doing a drag-and-drop operation.</span></span> <span data-ttu-id="c99b4-176">設定するインデックス値が返されます使用して、<xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>プロパティ。</span><span class="sxs-lookup"><span data-stu-id="c99b4-176">Use the index value returned to set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property.</span></span> <span data-ttu-id="c99b4-177">マウス ポインターに最も近い項目がドラッグされている項目と、このメソッドの戻り値は-1 です。</span><span class="sxs-lookup"><span data-stu-id="c99b4-177">When the item closest to the mouse pointer is the item being dragged, the return value of this method is -1.</span></span> <span data-ttu-id="c99b4-178">この場合、設定、<xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>プロパティをこの値には、挿入マークを非表示にします。</span><span class="sxs-lookup"><span data-stu-id="c99b4-178">In this case, setting the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to this value hides the insertion mark.</span></span>  
  
 <span data-ttu-id="c99b4-179">このメソッドは、マウス ポインターが中にある場所に関係なく、最も近い項目を検索、<xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType>メソッドのみ、指定した位置に項目を返しますまたは`null`その位置に項目がない場合。</span><span class="sxs-lookup"><span data-stu-id="c99b4-179">This method finds the closest item regardless of where the mouse pointer is located, while the <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType> method returns the item at the specified location only, or `null` if there is no item at that location.</span></span> <span data-ttu-id="c99b4-180"><xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType>メソッドを返します。 `null`、マウス ポインターが 2 つの項目間にある場合などです。</span><span class="sxs-lookup"><span data-stu-id="c99b4-180">The <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType> method returns `null`, for example, when the mouse pointer is located between two items.</span></span> <span data-ttu-id="c99b4-181">このためは常に使用する、<xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>メソッドをドラッグ アンド ドロップ操作を使用してアイテムを配置する場合。</span><span class="sxs-lookup"><span data-stu-id="c99b4-181">For this reason, you should always use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method when using a drag-and-drop operation to position items.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c99b4-182">次のコード例は、使用する方法を示します、<xref:System.Windows.Forms.ListView>挿入マーク機能および実装するドラッグ アンド ドロップの項目の並べ替えが標準を使用してイベントをドラッグします。</span><span class="sxs-lookup"><span data-stu-id="c99b4-182">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="c99b4-183">挿入マークの位置は、イベントのハンドラーで更新、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>イベント。</span><span class="sxs-lookup"><span data-stu-id="c99b4-183">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="c99b4-184">このハンドラーで、最も近い項目の中間点にマウス ポインターの位置を比較し、結果を使用して、アイテムの左右に挿入マークを表示するかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="c99b4-184">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 <span data-ttu-id="c99b4-185">完全な例では、次を参照してください。、<xref:System.Windows.Forms.ListViewInsertionMark>概要リファレンス トピック。</span><span class="sxs-lookup"><span data-stu-id="c99b4-185">For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
  </Members>
</Type>